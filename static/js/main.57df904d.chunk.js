(this["webpackJsonptrain-tracks"]=this["webpackJsonptrain-tracks"]||[]).push([[0],[,,,,,,function(e,t,n){e.exports=n.p+"static/media/curvedtrack.513c0cf6.png"},,,function(e,t,n){e.exports=n.p+"static/media/straighttrack.9d34a133.png"},,,,,function(e,t,n){e.exports=n(27)},,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(12),o=n.n(c),i=n(1),l=n(4),u=n(2),s=n.n(u),f=n(5),m=(n(20),n(3)),p=function(e){return r.a.createElement("div",{className:"white-background",style:{position:"absolute",top:"0",left:"0",height:"100%",width:"100%",background:"white",zIndex:"-2"}})},h=function(e){return{"top-left":{top:"0",left:"0",borderWidth:"0 0 ".concat(e/2,"rem ").concat(e/2,"rem")},"top-right":{top:"0",left:"".concat(e/2,"rem"),borderWidth:"0 ".concat(e/2,"rem ").concat(e/2,"rem 0")},"bottom-left":{top:"".concat(e/2,"rem"),left:"0",borderWidth:"".concat(e/2,"rem 0 0 ").concat(e/2,"rem")},"bottom-right":{top:"".concat(e/2,"rem"),left:"".concat(e/2,"rem"),borderWidth:"".concat(e/2,"rem ").concat(e/2,"rem 0 0")}}},d=function(){return{top:{top:"25%",left:"50%"},left:{top:"50%",left:"25%"},bottom:{top:"75%",left:"50%"},right:{top:"50%",left:"75%"}}},v=function(e){var t=function(e,t){var n=h(e)[t];return Object(i.a)({},{zIndex:"1",opacity:"0",height:"0",width:"0",borderStyle:"solid",position:"absolute"},{},n)}(e.tileRemSize,e.corner);return r.a.createElement("div",{className:"cornerButton ".concat(e.corner),style:t})},b=function(e){var t=function(e,t){var n={opacity:"0",position:"absolute",height:"".concat(e/2*.707106781,"rem"),width:"".concat(e/2*.707106781,"rem"),zIndex:"1",WebkitTransform:"rotate(45deg) translate(-50%, -50%)",MozTransform:"rotate(45deg) translate(-50%, -50%)",OTransform:"rotate(45deg) translate(-50%, -50%)",msTransform:"rotate(45deg) translate(-50%, -50%)",transform:"rotate(45deg) translate(-50%, -50%)",transformOrigin:"top left"},a=d()[t];return Object(i.a)({},n,{},a)}(e.tileRemSize,e.edge);return r.a.createElement("div",{className:"axisButton ".concat(e.edge),style:t})},g=function(e){var t,n=(t=e.tileRemSize,{opacity:"0",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",height:"".concat(t/5*2,"rem"),width:"".concat(t/5*2,"rem"),zIndex:"1",borderRadius:"5rem"});return r.a.createElement("div",{className:"centreButton",style:n})},y=function(e){return[["top-left","top-right","bottom-left","bottom-right"].map((function(t,n){return r.a.createElement(v,{key:"corner:".concat(n),corner:t,tileRemSize:e.tileRemSize})})),["top","right","bottom","left"].map((function(t,n){return r.a.createElement(b,{key:"edge:".concat(n),edge:t,tileRemSize:e.tileRemSize})})),r.a.createElement(g,{key:"center",tileRemSize:e.tileRemSize})]},k=n(6),E=n.n(k),O=n(9),w=n.n(O),x=function(e){var t,n;return 1===e.length&&(e[0]%2===0&&(t="vertical"),e[0]%2===1&&(t="horizontal"),n=t),2===e.length&&(e[0]%2===0&&e[1]%2===0&&(t="vertical"),e[0]%2===1&&e[1]%2===1&&(t="horizontal"),(0===e[0]&&1===e[1]||3===e[0]&&2===e[1])&&(t="bottomRightCorner"),(1===e[0]&&2===e[1]||0===e[0]&&3===e[1])&&(t="bottomLeftCorner"),(2===e[0]&&3===e[1]||1===e[0]&&0===e[1])&&(t="topLeftCorner"),(3===e[0]&&0===e[1]||2===e[0]&&1===e[1])&&(t="topRightCorner"),n=e[1]%2===0?"vertical":"horizontal"),[t,n]},S=function(e){var t;switch(e){case"vertical":t={trackType:w.a,trackRotation:0};break;case"horizontal":t={trackType:w.a,trackRotation:90};break;case"bottomLeftCorner":t={trackType:E.a,trackRotation:0};break;case"topLeftCorner":t={trackType:E.a,trackRotation:90};break;case"topRightCorner":t={trackType:E.a,trackRotation:180};break;case"bottomRightCorner":t={trackType:E.a,trackRotation:270};break;case"?":case"X":t={trackType:e,trackRotation:"none"};break;default:t={trackType:"none",trackRotation:"none"}}return t},C=function(e){var t;return e.target.classList.contains("axisButton")&&((e.target.classList.contains("top")||e.target.classList.contains("bottom"))&&(t="vertical"),(e.target.classList.contains("right")||e.target.classList.contains("left"))&&(t="horizontal")),e.target.classList.contains("cornerButton")&&(e.target.classList.contains("top-left")&&(t="topLeftCorner"),e.target.classList.contains("top-right")&&(t="topRightCorner"),e.target.classList.contains("bottom-left")&&(t="bottomLeftCorner"),e.target.classList.contains("bottom-right")&&(t="bottomRightCorner")),e.target.classList.contains("centreButton")&&(t="?"),t},T=function(e,t){return Object(i.a)({minHeight:"".concat(e,"rem"),minWidth:"".concat(e,"rem"),display:"flex",position:"relative",top:"0",left:"0",height:"".concat(e,"rem"),width:"".concat(e,"rem")},j(t))},j=function(e){return"mapTile"===e?{cursor:"cell"}:"defaultTrack"===e?{cursor:"auto"}:void 0},M=function(e){var t,n,c,o=Object(a.useState)(null),i=Object(l.a)(o,2),u=i[0],s=i[1],f=function(e){return{tile:e.currentTarget.id.split(",").map((function(e){return parseInt(e)})),railType:C(e),tileClass:m(e),mouseButton:e.buttons}},m=function(e){var t=e.currentTarget.className;return t.includes("mapTile")?"mapTile":t.includes("defaultTrack")?"defaultTrack":null};!e.trackData&&u&&(t=function(e,t){var n=S(e);return"?"!==n.trackType?{backgroundImage:"url(".concat(n.trackType,")"),transform:"rotate(".concat(n.trackRotation,"deg)"),opacity:.5}:{backgroundImage:"url(".concat(t,")"),opacity:1}}(u,e.railImages.unknown)),"mapTile"===e.className&&e.trackData&&(n=e.trackData,c=e.railImages,t="?"!==n.trackType&&"X"!==n.trackType?{backgroundImage:"url(".concat(n.trackType,")"),transform:"rotate(".concat(n.trackRotation,"deg)"),opacity:1}:"?"===n.trackType?{backgroundImage:"url(".concat(c.unknown,")"),opacity:1}:{backgroundImage:"url(".concat(c.cross,")"),opacity:1}),(e.trackData&&"defaultTrack"===e.className||e.trackData&&"completeTrack"===e.className)&&(t=function(e,t){return{backgroundImage:"url(".concat(e.trackType,")"),transform:"rotate(".concat(e.trackRotation,"deg)"),opacity:1,filter:t?"hue-rotate(200deg) saturate(10)":"none",transition:"filter 1s ease-in-out"}}(e.trackData,e.highlighted));var h=!0;return"mapTile"===e.className&&(e.trackData?h=1!==e.trackData.trackType.length:u&&(h="?"!==u)),r.a.createElement("div",{id:e.coordinate.toString(),style:T(e.tileRemSize,e.className),className:"square ".concat(e.className),onContextMenu:function(e){return e.preventDefault()},onMouseOver:function(t){return function(t){var n=f(t);e.hoverStartEvent(n),0===t.buttons&&s(n.railType)}(t)},onMouseLeave:function(e){return s(null)},onMouseDown:function(t){return function(t){var n=f(t);1===n.mouseButton&&e.leftClickEvent(n),2===n.mouseButton&&e.rightClickEvent(n),3===n.mouseButton&&e.bothClickEvent(n)}(t)},onMouseUp:function(t){return function(t){var n=f(t);0===t.button&&e.leftReleaseEvent(n),2===t.button&&e.rightReleaseEvent()}(t)}},r.a.createElement("div",{className:"tile-button-container",style:void 0},r.a.createElement(y,e)),r.a.createElement("div",{className:"tile-display",style:t},void 0),h&&r.a.createElement(p,e))},N=function(e){return r.a.createElement("div",{style:T(e.tileRemSize),className:"square",onContextMenu:function(e){return e.preventDefault()}},r.a.createElement("div",{style:{width:"100%",height:"100%",border:"1px solid black",display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement("p",{className:"boxLabel",style:function(e){switch(e){case"underfilled":return{WebkitTextFillColor:"white",WebkitTextStrokeColor:"black"};case"full":return{WebkitTextFillColor:"green",WebkitTextStrokeColor:"white"};case"overfilled":return{WebkitTextFillColor:"red",WebkitTextStrokeColor:"white"};default:return{WebkitTextFillColor:"white",WebkitTextStrokeColor:"black"}}}(e.fillState)},e.headerLabel)))},R=function(e){var t=Object(i.a)({},T(e.tileRemSize));return r.a.createElement("div",{style:t},r.a.createElement("div",{className:"tile-display",style:{border:"1px solid black",zIndex:"1"}}))},z=function(e){var t=Object(i.a)({},T(e.tileRemSize),{zIndex:"-2",opacity:"0"});return r.a.createElement("div",{style:t})},L=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},B=function(e,t){for(var n=-1,a=0;a<t.length;a++)D(e,t[a])&&(n=a);return n},D=function(e,t){var n=!1;return e.length===t.length&&(n=e.every((function(e,n){return e===t[n]}))),n},I=function(e){return Array.isArray(e)&&e.length>0},P=function(e){return e.filter((function(t,n){return n===B(t,e)}))},W=function(e){return e.filter((function(t,n){return n!==B(t,e)}))},G=function(e,t){return e.forEach((function(e){t=t.filter((function(t){return!D(t,e)}))})),t},H=function(){return Math.floor(Math.random()*Math.pow(10,15))},A=function(e){return e*parseFloat(getComputedStyle(document.documentElement).fontSize)},U=function(e,t){var n=t.filter((function(t){return D(e,t)}));return Boolean(n.length)},F=function(e){return e[L(0,e.length-1)]},V=function(e){var t=Math.floor(e.length/2);return e.slice(0,t)},q=function(e){var t=[];return e.tracks.forEach((function(e){e.defaultTrack&&t.push(e)})),t},X=function(e,t){var n=null;return t.forEach((function(t){t.tile[0]===e[0]&&t.tile[1]===e[1]&&(n=t.railType)})),n},J=function(e){return e.filter((function(e){return"X"!==e.railType})).length},Q=function(e,t){return e.tracks.filter((function(e){var n=e.defaultTrack;return t.forEach((function(t){D(e.tile,t.tile)&&e.railType===t.railType&&(n=!0)})),n})).length},Y={leftClickEvent:function(){return null},rightClickEvent:function(){return null},bothClickEvent:function(){return null},leftReleaseEvent:function(){return null},rightReleaseEvent:function(){return null},hoverStartEvent:function(){return null},dragArray:null,rightClickDragValue:null},K=function(e){var t=e.display,n=t.defaultHighlights,a=t.solutionVisible,c=t.saveBoxCutOut,o=function(t,n,a,c){return r.a.createElement(M,Object.assign({className:"mapTile",tileRemSize:e.tileRemSize,railImages:e.railImages,key:"".concat(t,",").concat(n),coordinate:[t,n],solutionVisible:c,trackData:a},e.activeMouseEventsObject))},i=function(t,n,a,c,o){return r.a.createElement(M,Object.assign({className:"defaultTrack",tileRemSize:e.tileRemSize,key:"".concat(t,",").concat(n),coordinate:[t,n],highlighted:c,trackData:S(a)},o))},l=function(t,a,c){var o,l=!1;return t.tracks.forEach((function(e){e.tile[0]===a&&e.tile[1]===c&&(o=e.railType,n&&e.defaultTrack&&(l=!0))})),o?function(e,t,n,a){return i(e,t,n,a,Y)}(a,c,o,l):r.a.createElement(R,{coordinate:[a,c],key:"".concat(a,",").concat(c),tileRemSize:e.tileRemSize})},u=function(t,a,r){var c=s(t,a,r);return c?function(t,n,a,r){return i(t,n,a,r,e.activeMouseEventsObject)}(a,r,c,n):function(t,n){var a;return e.placedTracks.forEach((function(e){e.tile[0]===t&&e.tile[1]===n&&(a=S(e.railType))})),o(t,n,a||null)}(a,r)},s=function(e,t,n){var a=null;return e.tracks.forEach((function(e){e.tile[0]===t&&e.tile[1]===n&&e.defaultTrack&&(a=e.railType)})),a},f=function(t,n){var a="underfilled",r=q(e.trainTrackMap),c="x"===t?0:1,o=r.filter((function(e){return e.tile[c]===n})).length,i=e.trainTrackMap.tracks.filter((function(e){return e.tile[c]===n})).length;return e.placedTracks.forEach((function(e){e.tile[c]===n&&"X"!==e.railType&&o++})),i<o?a="overfilled":i===o&&(a="full"),a},p=e.trainTrackMap.headerLabels.x.length,h=e.trainTrackMap.headerLabels.y.length;return Object(m.a)(Array((p+1)*(h+1))).map((function(t,n){var o=n%(p+1),i=Math.floor(n/(h+1))-1;return-1===i?function(t,n,a){var c=t.headerLabels.x[n],o=e.gameComplete?"full":f("x",n);return r.a.createElement(N,{key:"".concat(n,",").concat(a),headerLabel:c,fillState:o,tileRemSize:e.tileRemSize})}(e.trainTrackMap,o,i):o===p?function(t,n,a){var c=t.headerLabels.y[a],o=e.gameComplete?"full":f("y",a);return r.a.createElement(N,{key:"".concat(n,",").concat(a),headerLabel:c,fillState:o,tileRemSize:e.tileRemSize})}(e.trainTrackMap,o,i):c?r.a.createElement(z,{key:"".concat(o,",").concat(i),tileRemSize:e.tileRemSize}):function(t,n,r){return e.gameComplete||a?l(t,n,r):u(t,n,r)}(e.trainTrackMap,o,i)}))},Z=function(e,t){var n=$(e,t.mapTracks),a=_(n,t.placedTracks);return[].concat(Object(m.a)(n),Object(m.a)(a))},$=function(e,t){return e.filter((function(e){return 0===t.filter((function(t){return D(e.tile,t.tile)&&t.defaultTrack})).length}))},_=function(e,t){var n=[];return t.forEach((function(t){var a=!1;e.forEach((function(e){D(t.tile,e.tile)&&(a=!0)})),a||n.push(t)})),n},ee=function(e,t){var n,a=te(e,t);return D(a,[0,-1])&&(n=0),D(a,[1,0])&&(n=1),D(a,[0,1])&&(n=2),D(a,[-1,0])&&(n=3),n},te=function(e,t){return[e[0]-t[0],e[1]-t[1]]},ne=function(e,t){for(var n=[],a=function(a){var r=2*Math.ceil(a%3/2)+1,c=t.filter((function(t){return t[a%2]===e[a%2]})).filter((function(t){return t[(a+1)%2]*-r<e[(a+1)%2]*-r}));n.push(c)},r=0;r<4;r++)a(r);return n},ae=function(e,t){var n=ce(e,t);return n[L(0,n.length-1)]},re=function(e,t){var n=oe(e,t);return n[L(0,n.length-1)]},ce=function(e,t){var n=t.mapWidth,a=t.mapHeight,r=[];return 0===e[0]&&r.push(1),0===e[1]&&r.push(2),e[0]===n-1&&r.push(3),e[1]===a-1&&r.push(0),r},oe=function(e,t){var n=t.mapWidth,a=t.mapHeight,r=[];return 0===e[0]&&r.push(3),0===e[1]&&r.push(0),e[0]===n-1&&r.push(1),e[1]===a-1&&r.push(2),r},ie=function(e){var t=ye(e);return x(t).map((function(t,n){return{tile:e[n+1],railType:t}}))},le=function(e,t){var n=be(e[0],t);return de(e,t)?ue(e,t):I(n)?ve(e,n):ie([null].concat(Object(m.a)(e)))},ue=function(e,t){var n=me(e,t),a=se(n,e);return fe(a).map((function(t,n){return{tile:e[n],railType:t}}))},se=function(e,t){var n=function(e){for(var t=[],n=0;n<e.length-1;n++){var a=ee(e[n+1],e[n]);t.push(a)}return t}(t)[0],a=[];if(e[0]){var r=(e[0].position+2)%4;a.push(r)}else a.push(n);return a.push(n),e[1]?a.push(e[1].position):a.push(n),a},fe=function(e){for(var t=[],n=0;n<e.length-1;n++){var a=[e[n],e[n+1]],r=x(a)[0];t.push(r)}return t},me=function(e,t){var n=e.slice().reverse();return[pe(e,t),pe(n,t)]},pe=function(e,t){var n=he(e[0],t);if(n){var a=be(e[0],t),r=(a=a.filter((function(t){return!D(t.tile,e[1])}))).filter((function(e){return function(e,t){switch(e){case 0:if(("vertical"===t[0]||"topLeftCorner"===t[0]||"topRightCorner"===t[0])&&"vertical"===t[1]||"bottomLeftCorner"===t[1]||"bottomRightCorner"===t[1])return!0;break;case 1:if(("horizontal"===t[0]||"topRightCorner"===t[0]||"bottomRightCorner"===t[0])&&("horizontal"===t[1]||"topLeftCorner"===t[1]||"bottomLeftCorner"===t[1]))return!0;break;case 2:if(("vertical"===t[0]||"bottomLeftCorner"===t[0]||"bottomRightCorner"===t[0])&&"vertical"===t[1]||"topLeftCorner"===t[1]||"topRightCorner"===t[1])return!0;break;case 3:if(("horizontal"===t[0]||"topLeftCorner"===t[0]||"bottomLeftCorner"===t[0])&&("horizontal"===t[1]||"topRightCorner"===t[1]||"bottomRightCorner"===t[1]))return!0}return!1}(e.position,[n,e.railType])}));return F(r)}return null},he=function(e,t){var n=t.tracksOnMap.filter((function(t){return D(e,t.tile)}));return I(n)?n[0].railType:null},de=function(e,t){var n=t.tracksOnMap.filter((function(t){return D(t.tile,e[0])})).length,a=t.tracksOnMap.filter((function(t){return D(t.tile,e[1])})).length;return Boolean(n+a>0)},ve=function(e,t){var n=t.map((function(e){return e.tile})),a=[F(n),e[0],e[1]];return ie(a)},be=function(e,t){var n=function(e,t){var n=function(e,t){var n=[];return e[1]>0&&n.push({tile:[e[0],e[1]-1],position:0}),e[0]<t.x&&n.push({tile:[e[0]+1,e[1]],position:1}),e[1]<t.y&&n.push({tile:[e[0],e[1]+1],position:2}),e[0]>0&&n.push({tile:[e[0]-1,e[1]],position:3}),n}(e,t.axisMax),a=t.tracksOnMap.map((function(e){return e.tile}));return n.filter((function(e){return U(e.tile,a)}))}(e,t);return ge(n,t.tracksOnMap).filter((function(e){return t=e.position,n=e.railType,0===t&&("vertical"===n||"bottomLeftCorner"===n||"bottomRightCorner"===n)||3===t&&("horizontal"===n||"bottomRightCorner"===n||"topRightCorner"===n)||2===t&&("vertical"===n||"topLeftCorner"===n||"topRightCorner"===n)||1===t&&("horizontal"===n||"topLeftCorner"===n||"bottomLeftCorner"===n);var t,n}))},ge=function(e,t){var n=[];return e.forEach((function(e){t.forEach((function(t){D(e.tile,t.tile)&&n.push({tile:t.tile,railType:t.railType,position:e.position})}))})),n},ye=function(e){for(var t=[],n=0;n<e.length-1;n++)null!==e[n]&&null!==e[n+1]&&t.push(ee(e[n+1],e[n]));return t},ke=["#ff0000","#ffa500","#ffff00","#008000","#0000ff","#4b0082","#ee82ee"],Ee=function(){var e=100,t=L(e,255);t>255-e/2?e*=.8:e/=.8;var n=L(e,255);n>255-e/2?e*=.8:e/=.8;var a=L(e,255);return"rgb(".concat([t,n,a],")")},Oe=function(e,t){var n={colorOneArray:we(e),colorTwoArray:[255,255,255],numberOfShades:Math.ceil(t)};return Se(n).map((function(e){return xe(e)}))},we=function(e){return e.replace("#","").match(/.{1,2}/g).map((function(e){return parseInt(Number("0x".concat(e)),10)}))},xe=function(e){return"#"+e.map((function(e){var t=e.toString(16);return 1===t.length?"0"+t:t})).join("")},Se=function(e){for(var t=e.colorOneArray,n=e.numberOfShades,a=[],r=function(e){var t=e.colorOneArray,n=e.colorTwoArray,a=e.numberOfShades;return t.map((function(e,t){return(n[t]-e)/(a-1)}))}(e),c=function(e){var n=t.map((function(t,n){return Math.floor(t+e*r[n])}));a.push(n)},o=0;o<n;o++)c(o);return a},Ce=function(e,t,n){var a={colorOneArray:we(e),colorTwoArray:we(t),numberOfShades:Math.ceil(n)};return Se(a).map((function(e){return xe(e)}))},Te=function(){for(var e=[],t=0;t<ke.length-1;t++){var n=Ce(ke[t],ke[t+1],100);e.push(n)}return e=e.flat(),e},je=function(e){var t=e.themeColor.available[e.themeColor.selected],n=[];if(e.visualEffects)for(var a=Oe(t,21),c=0;c<20;c++){var o={backgroundColor:a[c],animation:"spin ".concat(15+.25*(c+1),"s infinite linear"),height:"".concat(100-4*c,"%"),width:"".concat(100-4*c,"%")};n.push(r.a.createElement("div",{key:c,className:"mapBackgroundShape",style:o}))}else{var i=Oe(t,10)[6];n.push(r.a.createElement("div",{style:{width:"100%",height:"100%",backgroundColor:i}}))}return r.a.createElement("div",{className:"mapBackgroundContainer"},n)},Me=function(e){var t=e.trainTrackMap,n=e.placedTracks,c=e.setPlacedTracks,o=e.setGameWon,i=e.savePopUp,u=e.themeColor,p=e.visualEffects,h=Object(a.useState)([]),d=Object(l.a)(h,2),v=d[0],b=d[1],g=Object(a.useRef)([null,null,null]),y=Object(a.useRef)(),k=Object(a.useRef)([null,null]),E=Object(a.useRef)(),O=function(e){var t=X(e.tile,n);y.current=null===t?"X":"DELETE"},w=function(e){"mapTile"===e.tileClass&&(X(e.tile,n)?R(e.tile):M(e.tile,y.current))},x=function(){var e=!0;return k.current[0]>E.current[0]+1&&(e=!1),k.current[0]<E.current[0]-1&&(e=!1),k.current[1]>E.current[1]+1&&(e=!1),k.current[1]<E.current[1]-1&&(e=!1),e},S=function(e){if(I(g.current)){g.current=(n=g.current,a=[e.tile],n.slice(a.length).concat(a));var t=function(e,t){var n=e.slice(1);return null===e[0]?le(n,t):ie(e)}(g.current,v);N(t)}var n,a},C=function(e){"X"===y.current?"mapTile"===e.tileClass&&M(e.tile,y.current):"DELETE"===y.current&&R(e.tile)},T=function(e){return j(e)},j=function(e){var t=e.tile,n=e.mouseButton,a=e.tileClass;3===n&&"mapTile"===a&&M(t,"?")},M=function(e,t){N([{tile:e,railType:t}])},N=function(){var e=Object(f.a)(s.a.mark((function e(a){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Z(a,{mapTracks:t.tracks,placedTracks:n}),e.next=3,c(r);case 3:return e.next=5,z();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(f.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.filter((function(e){return!(e.tile[0]===t[0]&&e.tile[1]===t[1])})),e.next=3,c(a);case 3:return e.next=5,z();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){(function(e,t){var n=Q(e,t),a=q(e).length,r=J(t);return n===e.tracks.length&&e.tracks.length===r+a})(t,n)&&o(!0)};Object(a.useEffect)((function(){return z()}),[n]),Object(a.useEffect)((function(){var e=t.tracks.filter((function(e){return e.defaultTrack})),a=n.filter((function(e){return"X"!==e.railType}));b({tracksOnMap:[].concat(Object(m.a)(e),Object(m.a)(a)),axisMax:{x:t.headerLabels.x.length,y:t.headerLabels.y.length}})}),[n]);var L={leftClickEvent:i?function(){return null}:function(e){return g.current=[null,null,e.tile]},rightClickEvent:i?function(){return null}:function(e){O(e),w(e)},bothClickEvent:i?function(){return null}:function(e){return j(e)},leftReleaseEvent:i?function(){return null}:function(e){1===g.current.filter((function(e){return e})).length&&"mapTile"===e.tileClass&&(M(e.tile,e.railType),g.current=[])},rightReleaseEvent:i?function(){return null}:function(){return y.current=void 0},hoverStartEvent:i?function(){return null}:function(e){(function(e){return!D(e.tile,k.current)})(e)&&(!function(e){E.current=k.current,k.current=e.tile}(e),1===e.mouseButton&&x()&&S(e),2===e.mouseButton&&C(e),3===e.mouseButton&&T(e))}};return r.a.createElement("div",{className:"map",style:{display:"grid",gridTemplateColumns:"repeat(".concat(t.headerLabels.x.length+1,", 1fr)"),gridTemplateRows:"repeat(".concat(t.headerLabels.y.length+1,", 1fr)")}},r.a.createElement(K,Object.assign({},e,{activeMouseEventsObject:L})),r.a.createElement(je,{themeColor:u,visualEffects:p}))},Ne=function(e){var t=e.display,n=e.tileRemSize,a=t.saveBoxCutOut;return r.a.createElement("img",{alt:"",draggable:"false",src:a,className:"saveBoxMapCutout",style:{position:"absolute",top:"".concat(n,"rem"),left:"0px",border:a?"1px solid black":"none"}})},Re={rectangleCount:5,startRotation:30,rotationOffset:2,get endRotation(){return this.rectangleCount*this.rotationOffset-15},startTransition:1.5,endTransition:3,transitionOffset:.1,cubicBezierFunction:"cubic-bezier(0,1.84,0,.32)"},ze=function(e){var t=e.className,n=e.onClick,c=e.text,o=e.bounceDelay,u=void 0===o?200:o,s=e.clickDelay,f=void 0===s?500:s,m=Object(a.useState)(!1),p=Object(l.a)(m,2),h=p[0],d=p[1],v=Object(a.useState)(!1),b=Object(l.a)(v,2),g=b[0],y=b[1],k=Object(a.useRef)(),E=Object(a.useRef)(),O=function(e){return{btnDefaultStyle:{position:"relative",overflow:"hidden",cursor:"pointer",background:"none",zIndex:"0",borderRadius:"1rem",border:"1px #ccc solid",outline:"none",transition:"0.3s",top:"0px",boxShadow:"0px 5px 0px 2px #eee"},btnPressedStyle:{transition:"0.1s",top:"10px",boxShadow:"none"},rectangleStyle:{top:"0%",left:"-30%",height:"350%",width:"70rem",position:"absolute",zIndex:"-1",borderRadius:"50rem"},textStyle:{zIndex:"1",color:e?"white":"black",transition:e?"color 1s cubic-bezier(0,2.53,.53,-1.51)":"color 0s"},whiteBackground:{zIndex:"-2",top:"0",left:"0",position:"absolute",height:"100%",width:"100%",backgroundColor:"white"}}}(h),w=O.btnDefaultStyle,x=O.btnPressedStyle,S=O.rectangleStyle,C=O.textStyle,T=O.whiteBackground,j=Re.rectangleCount,M=Re.startRotation,N=Re.rotationOffset,R=Re.endRotation,z=Re.startTransition,L=Re.endTransition,B=Re.transitionOffset,D=Re.cubicBezierFunction,I=function(e){for(var t=[],n=Oe("#5bb1cd",1.2*e),a=Oe("#800080",1.2*e),c=0;c<e;c++){var o={background:"linear-gradient(1turn,".concat(n[n.length-c-1],",").concat(a[a.length-c-1],")"),transform:h?"rotate(".concat(R+N*c,"deg) skewY(0deg)"):"rotate(".concat(M+N*c,"deg) skewY(45deg)"),transition:h?"all ".concat(z+B*c,"s ").concat(D):"all ".concat(L,"s ").concat(D)};t.push(r.a.createElement("div",{key:c,style:Object(i.a)({},S,{},o),className:"rectangle",id:"rec".concat(c)}))}return t}(j),P=g?Object(i.a)({},w,{},x):w;return r.a.createElement("button",{style:P,className:t,onMouseOver:function(){return d(!0)},onMouseLeave:function(){return g?null:d(!1)},onClick:function(){y(!0),k.current=setTimeout((function(){return y(!1),clearTimeout(k.current)}),u),E.current=setTimeout((function(){return n(),clearTimeout(E.current)}),f)}},I,r.a.createElement("div",{style:C},c),r.a.createElement("div",{style:T}))},Le=function(e){return r.a.createElement("div",{className:"mapSeedOptionContainer"},r.a.createElement(ze,{style:{zIndex:"4"},className:"mapSeedBtn",key:"mapSeedBtn",onClick:function(){return navigator.clipboard.writeText(e.seed)},text:"\ud83c\udf31"}),r.a.createElement("div",{className:"mapSeedExplanation"},r.a.createElement("span",null,"Copy map seed to clipboard")))},Be=function(e,t){var n=t.map((function(e){return e.tile})),a=t.map((function(e){return e.railType})),r=Object(m.a)(e).filter((function(e){if(e.defaultTrack)return!1;var t=B(e.tile,n);return-1===t||a[t]!==e.railType}));return I(r)?F(r):null},De=function(e,t){if(!e)return t;var n=t.filter((function(t){return!D(e.tile,t.tile)}));return[].concat(Object(m.a)(n),[e])},Ie=function(e){var t=e.gameState,n=e.placedTracks,a=e.setGameWon,c=e.setPlacedTracks,o=e.setDisplay,l=e.display,u=e.inGameNewMap,m=e.quitGame,p=t.seed,h=t.mapObject.tracks;return r.a.createElement("div",{className:"inGameOptions"},r.a.createElement("div",{className:"topRowInGameButtons"},r.a.createElement(ze,{key:"addHintTrackButton",onClick:function(){var e=function(e,t){var n=Be(e,t);return De(n,t)}(h,n);c(e)},text:"Add Hint Track",clickDelay:50}),r.a.createElement(ze,{key:"highlightDefaultTilesBtn",onClick:function(){return o(Object(i.a)({},l,{defaultHighlights:!l.defaultHighlights}))},text:l.defaultHighlights?"Hide Default Tiles":"Show Default Tiles",clickDelay:50}),r.a.createElement(ze,{key:"showMapSolutionBtn",onClick:function(){return o(Object(i.a)({},l,{solutionVisible:!l.solutionVisible}))},text:l.solutionVisible?"Hide Map Solution":"Show Map Solution",clickDelay:200})),r.a.createElement("div",{className:"bottomRowInGameButtons"},r.a.createElement(ze,{key:"resetMapBtn",onClick:Object(f.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a(!1),c([]),o(Object(i.a)({},l,{winPopUp:!1,solutionVisible:!1}));case 3:case"end":return e.stop()}}),e)}))),text:"Reset Map",clickDelay:100}),r.a.createElement(ze,{key:"saveMapBtn",onClick:function(){return o(Object(i.a)({},l,{savePopUp:!0,winPopUp:!1}))},text:"Save Map",clickDelay:100}),r.a.createElement(Le,{seed:p}),r.a.createElement(ze,{key:"newMapBtn",onClick:function(){a(!1),c([]),o(Object(i.a)({},l,{winPopUp:!1,solutionVisible:!1})),u()},text:"New Map",clickDelay:200}),r.a.createElement(ze,{key:"quitBtn",onClick:function(){return m()},text:"Quit Game"})))},Pe=function(){var e=Object(f.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=JSON.parse(window.localStorage.getItem("savedMaps")),!I(n)){e.next=7;break}return a=[].concat(Object(m.a)(n),[t]),e.next=5,window.localStorage.setItem("savedMaps",JSON.stringify(a));case 5:e.next=9;break;case 7:return e.next=9,window.localStorage.setItem("savedMaps",JSON.stringify([t]));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),We=function(){var e=JSON.parse(window.localStorage.getItem("savedMaps"));return I(e)||(e=[]),e},Ge=function(){var e=Object(f.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=We(),a=n.filter((function(e){return e.seed!==t})),e.next=4,window.localStorage.setItem("savedMaps",JSON.stringify(a));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),He=function(){var e=Object(f.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.localStorage.setItem("savedMaps",JSON.stringify([]));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ae=function(e){var t=e.display,n=e.setDisplay,c=e.gameState,o=Object(a.useState)(null),u=Object(l.a)(o,2),s=u[0],f=u[1];return r.a.createElement("div",{key:"saveMapDisplay",className:"saveMapDisplay",onContextMenu:function(e){return e.preventDefault()}},r.a.createElement("p",null,"Enter a name to save map as:"),r.a.createElement("button",{key:"closeSaveMapDisplay",className:"closePopUpWindow",onClick:function(){return n(Object(i.a)({},t,{savePopUp:!1}))}},"X"),r.a.createElement("input",{key:"saveNameInputBox",className:"saveNameInputBox",onChange:function(e){return f(e.target.value)}}),r.a.createElement(ze,{key:"confirmSaveMapBtn",className:"confirmSaveMapBtn",onClick:function(){Pe(Object(i.a)({name:s},c)),f(null),n(Object(i.a)({},t,{savePopUp:!1}))},text:"Save Map"}))},Ue=(n(21),function(e){var t=[],n=e.themeColor.available[e.themeColor.selected];if(e.visualEffects)for(var a=0;a<300;a++){var c=Ee(),o=e.visualEffects?L(-20,100):50,i=e.visualEffects?L(0,1e4):0,l={left:"".concat(o,"%"),backgroundColor:c,color:c,opacity:0,animationDelay:"".concat(i,"ms")};t.push(r.a.createElement("div",{key:a,className:"balloon",style:l},r.a.createElement("div",{key:"balloonString".concat(a),className:"balloonString"},"\u0601")))}else{var u=Oe(n,10)[8];t.push(r.a.createElement("div",{style:{width:"100%",height:"100%",backgroundColor:u}}))}return t}),Fe=function(e){var t=e.display,n=e.setDisplay,a=e.visualEffects,c=e.themeColor;return r.a.createElement("div",{key:"gameWinDisplay",className:"winDisplay",onContextMenu:function(e){return e.preventDefault()}},r.a.createElement("h2",{key:"winText",className:"winText"},"You Win!"),r.a.createElement("button",{key:"closeWinDisplay",className:"closePopUpWindow",onClick:function(){return n(Object(i.a)({},t,{winPopUp:!1}))}},"X"),r.a.createElement("div",{key:"balloonContainer",className:"balloonContainer"},r.a.createElement(Ue,{visualEffects:a,themeColor:c})))},Ve=function(){var e=Object(f.a)(s.a.mark((function e(t,n){var a,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:!0,complete:n,dimensions:250,cutOut:!1},e.next=3,Qe(t,a);case 3:return r=e.sent,c=r.toDataURL("image/png"),e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),qe=function(){var e=Object(f.a)(s.a.mark((function e(t,n){var a,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:!1,complete:!1,dimensions:A(n)*t.headerLabels.x.length,cutOut:!0},e.next=3,Qe(t,a);case 3:return r=e.sent,c=r.toDataURL("image/png"),e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Xe=function(){var e=Object(f.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Ye(w.a),Ye(E.a)]);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Je=function(){var e=Object(f.a)(s.a.mark((function e(t,n){var a,r,c,o,i,u,f,m,p,h,d,v;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=document.createElement("canvas"),r=a.getContext("2d"),a.width=n.dimensions,a.height=n.dimensions,c=t.headerLabels.x.length,o=t.headerLabels.y.length,i=c+n.headers,u=o+n.headers,f=a.width/i,m=a.height/u,e.next=12,Xe();case 12:return p=e.sent,h=Object(l.a)(p,2),d=h[0],v=h[1],e.abrupt("return",{canvas:a,context:r,iconTile:{width:f,height:m},map:{width:c,height:o},gridMap:{width:i,height:u},trackImage:{straight:d,curved:v},options:n});case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Qe=function(){var e=Object(f.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Je(t,n);case 2:return(a=e.sent).context=Ke(a),a.context=Ze(t,a),a.context=$e(t,a),n.cutOut&&(a.context=at(a)),e.abrupt("return",a.canvas);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ye=function(e){return new Promise((function(t,n){var a=new Image;a.onload=function(){return t(a)},a.onerror=n,a.src=e}))},Ke=function(e){var t=e.canvas,n=e.context;return n.fillStyle="white",n.fillRect(0,0,t.width,t.height),n},Ze=function(e,t){var n=t.options,a=t.context;return e.tracks.forEach((function(e){(n.complete||e.defaultTrack)&&(a="horizontal"===e.railType||"topLeftCorner"===e.railType||"topRightCorner"===e.railType||"bottomRightCorner"===e.railType?function(e,t){var n=t.context,a=t.options,r=t.iconTile,c=r.width,o=r.height,i=t.trackImage,l=i.straight,u=i.curved,s=function(e){var t;switch(e){case"horizontal":case"topLeftCorner":t=90;break;case"topRightCorner":t=180;break;case"bottomRightCorner":t=270;break;default:t=0}return t}(e.railType);return n.save(),n.translate(e.tile[0]*c+c/2,(e.tile[1]+a.headers)*o+o/2),n.rotate(s*(Math.PI/180)),n.drawImage("vertical"===e.railType||"horizontal"===e.railType?l:u,-c/2,-o/2,c,o),n.restore(),n}(e,t):function(e,t){var n=t.context,a=t.options,r=t.iconTile,c=r.width,o=r.height,i=t.trackImage,l=i.straight,u=i.curved;return n.drawImage("vertical"===e.railType||"horizontal"===e.railType?l:u,e.tile[0]*c,(e.tile[1]+a.headers)*o,c,o),n}(e,t))})),a},$e=function(e,t){for(var n=t.context,a=t.gridMap,r=t.iconTile,c=t.options,o=t.map,i=0;i<a.width*a.height;i++){var l=i%a.width,u=Math.floor(i/a.height);if(c.headers&&(l===o.width||0===u))n=_e({tile:{x:l,y:u},mapObject:e},t);n.fillStyle="black",n.strokeRect(l*r.width,u*r.height,r.width,r.height)}return n},_e=function(e,t){var n=t.context,a=t.map.width,r=e.tile,c=r.x,o=r.y;return n=et(e.tile,t),(0===o&&c!==a||c===a&&0!==o)&&(n=tt(e,t)),n},et=function(e,t){var n=t.context,a=t.iconTile,r=e.x,c=e.y;return n.fillStyle="#FFE4B5",n.fillRect(r*a.width,c*a.height,a.width,a.height),n},tt=function(e,t){var n=t.context,a=t.iconTile,r=e.tile,c=r.x,o=r.y;return n.fillStyle="black",n.font="1.5rem Georgia",n.textAlign="center",n.textBaseline="middle",n.fillText(nt(e,t),(c+.5)*a.width,(o+.5)*a.height),n},nt=function(e,t){var n=t.map.width,a=e.mapObject,r=e.tile,c=r.x,o=r.y,i="ERROR";return 0===o&&c!==n&&(i=a.headerLabels.x[c]),c===n&&0!==o&&(i=a.headerLabels.y[o-1]),i},at=function(e){var t=e.context,n=e.iconTile,a=e.map;return t.clearRect((a.width+1)*n.width/2-125,(a.height-1)*n.height/2-75,250,150),t.strokeRect((a.width+1)*n.width/2-125,(a.height-1)*n.height/2-75,250,150),t},rt=n(7),ct=function(e,t){var n;return n={display:"inline-block",position:"relative",zIndex:"0",marginBottom:"1rem",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",boxSizing:"border-box"},Object(rt.a)(n,"position","relative"),Object(rt.a)(n,"width","".concat((e+1)*t,"rem")),Object(rt.a)(n,"height","".concat((e+1)*t,"rem")),n},ot=function(e){var t=e.gameState,n=e.tileRemSize,c=e.visualEffects,o=e.themeColor,u=(e.mapSeed,e.railImages),m=e.inGameNewMap,p=e.quitGame,h=Object(a.useState)(!1),d=Object(l.a)(h,2),v=d[0],b=d[1],g=Object(a.useState)([]),y=Object(l.a)(g,2),k=y[0],E=y[1],O=Object(a.useState)({winPopUp:!1,savePopUp:!1,saveBoxCutOut:null,defaultHighlights:!1,solutionVisible:!1}),w=Object(l.a)(O,2),x=w[0],S=w[1];Object(a.useEffect)((function(){Object(f.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!x.savePopUp){e.next=13;break}return e.t0=S,e.t1=i.a,e.t2={},e.t3=x,e.next=7,qe(t.mapObject,n);case 7:e.t4=e.sent,e.t5={saveBoxCutOut:e.t4},e.t6=(0,e.t1)(e.t2,e.t3,e.t5),(0,e.t0)(e.t6),e.next=14;break;case 13:S(Object(i.a)({},x,{saveBoxCutOut:null}));case 14:case"end":return e.stop()}}),e)})))()}),[x.savePopUp]),Object(a.useEffect)((function(){v&&S(Object(i.a)({},x,{winPopUp:!0}))}),[v]);var C={placedTracks:k,setPlacedTracks:E,visualEffects:c,display:x,setGameWon:b};return r.a.createElement("div",null,r.a.createElement("div",{style:ct(t.size,n)},x.winPopUp&&r.a.createElement(Fe,{display:x,setDisplay:S,visualEffects:c,themeColor:o}),x.savePopUp&&r.a.createElement(Ae,{display:x,setDisplay:S,gameState:t}),r.a.createElement(Me,Object.assign({tileRemSize:n,railImages:u,themeColor:o},{trainTrackMap:t.mapObject},C)),r.a.createElement(Ne,{display:x,tileRemSize:n})),r.a.createElement(Ie,Object.assign({setDisplay:S,gameState:t,inGameNewMap:m,quitGame:p},C)))},it=n(13),lt=function(e){var t=e.style,n=e.placeholder,c=e.options,o=e.onChange,u=e.onHover,s=e.className,f=Object(a.useState)(!1),m=Object(l.a)(f,2),p=m[0],h=m[1],d=Object(a.useState)(n),v=Object(l.a)(d,2),b=v[0],g=v[1],y=Object(a.useState)(null),k=Object(l.a)(y,2),E=k[0],O=k[1],w=Object(i.a)({background:"#fff",border:"1px #aaa solid",lineHeight:t.height},t,{position:"relative",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",borderRadius:p?"1rem 1rem 0 0":"1rem",boxShadow:"0px 5px 0px 2px #eee",cursor:"pointer"}),x=Object(i.a)({},w,{borderTop:"none"});Object(a.useEffect)((function(){return p?document.addEventListener("mousedown",S):document.removeEventListener("mousedown",S),function(){return document.removeEventListener("mousedown",S)}}));var S=function(e){"dropdown"!==e.target.className&&(h(!1),u(!1))},C=function(e,t){o(e,t),h(!1)},T=function(e){return u(e)};return r.a.createElement("div",{className:s},r.a.createElement("div",{className:"dropdown",style:Object(i.a)({},w,{backgroundColor:"#fff"}),onMouseDown:function(e){1===e.buttons&&h(!p)},onContextMenu:function(e){return e.preventDefault()}},b,r.a.createElement("span",{style:{fontSize:"0.75rem",position:"absolute",right:"5%"}},"\u25bc")),r.a.createElement("div",{style:{position:"absolute"}},p?function(e){var t=[];return e.forEach((function(n,a){t.push(r.a.createElement("div",{className:"dropdown",style:Object(i.a)({},x,{background:E===a?"#9999FF":"#fff",color:E===a?"white":"black",borderRadius:a===e.length-1?"0 0 1rem 1rem":"0"}),key:"dropdownOption".concat(a),onClick:function(){C(n),g(n.display)},onMouseOver:function(){T(n.mapObject),O(a)},onMouseLeave:function(){T(null),O(null)},onContextMenu:function(e){return e.preventDefault()}},n.display))})),t}(c):null))},ut=(n(22),function(e){return r.a.createElement("div",{className:"deleteConfirmScreen"},r.a.createElement("h3",{className:"deleteConfirmLabel"},"Are you sure you want to delete ",e.deleteModeOnAll?"ALL saved maps?":"the following saved map?"),r.a.createElement("img",{alt:"",src:e.deleteModeOnAll?null:e.mapIcon,style:{display:e.deleteModeOnAll?"none":"block"},className:"confirmDeleteIcon"}),r.a.createElement("div",{className:"deleteButtons"},r.a.createElement(ze,{className:"confirmDeleteBtn",key:"confirmDeleteBtn",onClick:function(){e.deleteModeOnAll?He():Ge(e.gameState.seed),e.quitToLoadScreen()},text:"Confirm"}),r.a.createElement(ze,{className:"cancelDeleteBtn",key:"cancelDeleteBtn",onClick:function(){e.quitToLoadScreen()},text:"Cancel"})))}),st=function(e){return r.a.createElement(ze,{className:"returnToMainMenuBtn",key:"returnToMainMenuBtn",onClick:function(){e.setCurrentScreen("mainMenu")},text:"Return To Main Menu"})},ft=function(){var e=We(),t=[];return e.forEach(function(){var e=Object(f.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.push({display:n.name,seed:n.seed,size:n.size,mapObject:n.mapObject});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t},mt=function(e){var t=Object(a.useState)("load"),n=Object(l.a)(t,2),c=n[0],o=n[1],u=Object(a.useState)(null),m=Object(l.a)(u,2),p=m[0],h=m[1],d=function(){var e=Object(f.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=h,!t){e.next=7;break}return e.next=4,Ve(t,!1);case 4:e.t1=e.sent,e.next=8;break;case 7:e.t1=null;case 8:e.t2=e.t1,(0,e.t0)(e.t2);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();if("load"===c)return r.a.createElement("div",{className:"menu loadMapScreen"},r.a.createElement(lt,{className:"loadMapDropdown",style:{width:"12rem",height:"2rem"},placeholder:"Select a map",options:ft(),onChange:function(t){t.display;var n=Object(it.a)(t,["display"]);e.setGameState(Object(i.a)({},e.gameState,{},n))},onHover:function(e){null!==e&&d(e)}}),r.a.createElement("img",{alt:"",src:p,className:"mapIcon",style:{border:p?"0.15rem #aaa solid":"none"}}),r.a.createElement(ze,{className:"loadSaveMapBtn",key:"loadSaveMapBtn",onClick:function(){e.gameState.mapObject&&e.setGameState(Object(i.a)({},e.gameState,{active:!0}))},text:"Load Map"}),r.a.createElement(ze,{className:"deleteSaveMapBtn",key:"deleteSaveMapBtn",onClick:function(){p&&o("deleteOne")},text:"Delete Map"}),r.a.createElement(ze,{className:"deleteAllSavedMapsBtn",key:"deleteAllSavedMapsBtn",onClick:function(){return o("deleteAll")},text:"Delete All Maps"}),r.a.createElement(st,e));var v="deleteOne"!==c;return r.a.createElement(ut,Object.assign({},e,{mapIcon:p,deleteModeOnAll:v,quitToLoadScreen:function(){h(null),o("load")}}))},pt=(n(23),function(e){for(var t=e.mapWidth,n=e.mapHeight,a=[],r=0;r<t-1;r++)a.push([r,0]);for(var c=0;c<n-1;c++)a.push([t-1,c]);for(var o=t-1;o>0;o--)a.push([o,n-1]);for(var i=n-1;i>0;i--)a.push([0,i]);return a}),ht=function(e,t){var n=bt(e),a=dt(n,t.parameters);return a=vt(a,t.tiles)},dt=function(e,t){var n=t.mapWidth,a=t.mapHeight;return e.filter((function(e){return e[0]>=0&&e[1]>=0&&e[0]<n&&e[1]<a}))},vt=function(e,t){return G(t,e)},bt=function(e){return Array(4).fill(e).map((function(e,t){return[e[0]+(t-1)%2,e[1]+(t-2)%2]}))},gt=function(e,t){for(var n=t.parameters,a=n.mapWidth,r=n.mapHeight,c=Object(m.a)(t.tiles),o=[e],l=0;l<a*r;l++){var u=o.map((function(e){return ht(e,Object(i.a)({},t,{tiles:c}))}));if(u=[].concat.apply([],u),o.forEach((function(e){return c.push(e)})),o=[],0===u.length)break;(u=P(u)).forEach((function(e){return o.push(e)}))}return U(t.end,c)},yt=function(e,t){var n=t.mapLength,a=t.difficulty,r=kt(e,n);return 1===a?[].concat(Object(m.a)(e),Object(m.a)(r)):2===a?[].concat(Object(m.a)(e),Object(m.a)(V(r))):3===a?e:4===a?V(e):5===a?[]:void 0},kt=function(e,t){var n=function(e){for(var t,n,a=e.length;a;)n=Math.floor(Math.random()*a),t=e[--a],e[a]=e[n],e[n]=t;return e}(Object(m.a)(Array(t).keys()).filter((function(t){return-1===e.indexOf(t)})));return V(n)},Et=function(e){return[0,e.length-1]},Ot=function(e,t){var n=wt(e,t),a=(n=xt(n)).map((function(t){return B(t,e)}));return Object(m.a)(new Set(a))},wt=function(e,t){for(var n,a=e,r=[],c=0;c<2;c++)for(var o=0;o<2;o++){var i=Ct(a,{x:o,y:c},t);r.push(i),a=G(i,e)}return(n=[]).concat.apply(n,r)},xt=function(e){var t=Object(m.a)(e);return e.filter((function(e){var n=St(e,t)>1;return n&&(t=G([e],t)),!n}))},St=function(e,t){var n=bt(e);return 4-G(t,n).length},Ct=function(e,t,n){var a=Nt(t,n),r=jt(e,a);return Tt(r)},Tt=function(e){var t=e.map((function(e){return e[L(0,e.length-1)]}));return P(t)},jt=function(e,t){return t.filter((function(t){return Mt(t,e)}))},Mt=function(e,t){return 4===function(e){for(var t=e.map((function(e){return P(e)})),n=t[0],a=0;a<t.length-1;a++){var r=[].concat(Object(m.a)(n),Object(m.a)(t[a+1]));n=W(r)}return n}([e,t]).length},Nt=function(e,t){for(var n=t.mapWidth,a=t.mapHeight,r=[],c=e.y;c<a-1-e.y;c+=2)for(var o=e.x;o<n-1-e.x;o+=2)r.push(Rt(o,c));return r},Rt=function(e,t){for(var n=[],a=0;a<2;a++)for(var r=0;r<2;r++)n.push([r+e,a+t]);return n},zt=function(e,t){return e=e.filter((function(e){return!D(e,t.end)}))},Lt=function(e,t){return e=e.filter((function(e){return!Bt(e,t)}))},Bt=function(e,t){var n=Dt(e,t),a=!1;return n.forEach((function(t){D(e,t)&&(a=!0)})),a},Dt=function(e,t){return It(e,t)?Pt(t):Gt(t)},It=function(e,t){var n=Gt(t);return-1!==B(e,n)},Pt=function(e){var t=Wt(e.end);return dt(t,e.parameters)},Wt=function(e){for(var t=[],n=-1;n<=1;n++)for(var a=-1;a<=1;a++)t.push([e[0]+n,e[1]+a]);return t},Gt=function(e){var t=bt(e.end);return dt(t,e.parameters)},Ht=function(e,t){return At(t,.5)||(e=e.filter((function(e){return!Ut(e,t)}))),e},At=function(e,t){var n=e.parameters,a=t*n.mapWidth*n.mapHeight;return e.tiles.length>=a},Ut=function(e,t){for(var n=Object(i.a)({},t,{tiles:[].concat(Object(m.a)(t.tiles),[e])}),a=ht(e,t),r=0;r<a.length;r++)if(!gt(a[r],n))return!0;return!1},Ft=function(e,t){return t.tiles.length>2&&(e=e.filter((function(e){return!Vt(e,t.tiles)}))),e},Vt=function(e,t){var n=Xt(3,t),a=[e].concat(Object(m.a)(n)),r=qt(a);return Jt(r)},qt=function(e){for(var t=[],n=0;n<e.length-1;n++)t.unshift(ee(e[n],e[n+1]));return t},Xt=function(e,t){return t.slice(Math.max(t.length-e,0)).reverse()},Jt=function(e){var t=!1;return(D(e,[0,1,2])||D(e,[1,2,3])||D(e,[2,3,0])||D(e,[3,0,1]))&&(t=!0),(D(e,[3,2,1])||D(e,[2,1,0])||D(e,[1,0,3])||D(e,[0,3,2]))&&(t=!0),t},Qt=function(e,t){var n=Yt(e,t);return I(n)?Object(m.a)(n):e},Yt=function(e,t){for(var n=e.map((function(e){return Kt(e,t)})),a=Zt(n),r=[],c=0;c<a.length;c++)r.push(e[a[c]]);return r},Kt=function(e,t){for(var n=t.parameters,a=n.mapWidth,r=n.mapHeight,c=Object(m.a)(t.tiles),o=[e],l=0;l<a*r;l++){var u=o.map((function(e){return ht(e,Object(i.a)({},t,{tiles:c}))}));if(u=[].concat.apply([],u),o.forEach((function(e){return c.push(e)})),o=[],U(t.end,c))return l;(u=P(u)).forEach((function(e){return o.push(e)}))}},Zt=function(e){for(var t=e[e.indexOf(Math.max.apply(Math,Object(m.a)(e)))],n=[],a=0;a<e.length;a++)e[a]===t&&n.push(a);return n},$t=function(e){var t={mapWidth:e.size,mapHeight:e.size,difficulty:e.difficulty},n={tracks:[],headerLabels:[]},a=_t(t),r=function(e){for(var t=[],n=0;n<e.length;n++)(0===e[n]&&0===e[n+1]||2===e[n]&&2===e[n+1])&&t.push("vertical"),(1===e[n]&&1===e[n+1]||3===e[n]&&3===e[n+1])&&t.push("horizontal"),(2===e[n]&&1===e[n+1]||3===e[n]&&0===e[n+1])&&t.push("topRightCorner"),(3===e[n]&&2===e[n+1]||0===e[n]&&1===e[n+1])&&t.push("bottomRightCorner"),(0===e[n]&&3===e[n+1]||1===e[n]&&2===e[n+1])&&t.push("bottomLeftCorner"),(1===e[n]&&0===e[n+1]||2===e[n]&&3===e[n+1])&&t.push("topLeftCorner");return t}(function(e,t){var n=[];n.push(ae(e[0],t));for(var a=0;a<e.length-1;a++){var r=ee(e[a+1],e[a]);n.push(r)}return n.push(re(e[e.length-1],t)),n}(a,t)),c=function(e,t){var n=Ot(e,t),a={mapLength:e.length,difficulty:t.difficulty},r=yt(n,a),c=Et(e);return Object(m.a)(new Set([].concat(Object(m.a)(r),Object(m.a)(c))))}(a,t);n.headerLabels=an(a,t);for(var o=0;o<a.length;o++){var i=c.includes(o);n.tracks.push({tile:a[o],railType:r[o],defaultTrack:i})}return n},_t=function(e){for(var t=function(e){var t=pt(e);return[t.splice(Math.floor(Math.random()*t.length),1)[0],t.splice(Math.floor(Math.random()*t.length),1)[0]]}(e),n=Object(l.a)(t,2),a=n[0],r={start:a,end:n[1],tiles:[a],current:a,parameters:e},c=!1;!c;){var o=en(r);r.tiles.push(o),r.current=o,D(o,r.end)&&(c=!0)}return r.tiles},en=function(e){var t,n=ht(e.current,e);return tn(n,e.end)?t=e.end:(n=n.filter((function(t){return gt(t,e)})),t=(n=nn(n,e))[L(0,n.length-1)]),t},tn=function(e,t){return 1===e.length&&D(e[0],t)},nn=function(e,t){var n=[];n.push(zt),n.push(Lt),n.push(Ht),n.push(Ft),n.push(Qt);for(var a=0;a<n.length;a++){var r=(0,n[a])(e,t);if(!I(r))break;e=r}return e},an=function(e,t){for(var n=t.mapWidth,a=t.mapHeight,r={x:[],y:[]},c=0;c<n;c++)r.x.push(ne([c,-1],e)[2].length);for(var o=0;o<a;o++)r.y.push(ne([-1,o],e)[1].length);return r},rn=function(e){var t=e.mobileView;console.log(t);var n=Object(a.useState)(!1),c=Object(l.a)(n,2),o=c[0],i=c[1];return Object(a.useEffect)((function(){(function(){var e=Object(f.a)(s.a.mark((function e(){var t,n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=$t({size:6,seed:0xe4d067d44f90,difficulty:3}),e.next=4,Ve(t,!1);case 4:return n=e.sent,e.next=7,Ve(t,!0);case 7:a=e.sent,i({empty:n,complete:a});case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),r.a.createElement("div",{className:"howToPlayScreen",key:"howToPlayScreen"},r.a.createElement("h2",{className:"howToPlayTitle"},"How To Play"),r.a.createElement("div",{className:"howToPlayGrid",style:{opacity:o?"1":"0"}},r.a.createElement("div",{className:"howToPlayMapField"},r.a.createElement("img",{className:"howToPlayMap",alt:"",src:o.empty})),r.a.createElement("div",{className:"howToPlayTextField"},r.a.createElement("p",null,"The goal of the game is to create a train track path between the entrance and the exit of the board."),r.a.createElement("p",null,"Each row and column must contain the specified amount of tracks in the corresponding header. Headers display green if correct and red if overfilled."),r.a.createElement("p",null,"Tracks cannot overlap. In order to win the path must be fully connected with no extra tracks."),r.a.createElement("p",null,"Default tiles (such as the entrance and exit) cannot be removed from the map. The higher the difficulty selected, the less default tiles on the map.")),r.a.createElement("div",{className:"howToPlayMapField"},r.a.createElement("img",{className:"howToPlayMap",alt:"",src:o.complete})),r.a.createElement("div",{className:"howToPlayTextField"},r.a.createElement("p",null,"Left clicking places a track. Hovering over different sections of a tile will show what type of track will be placed on left click."),r.a.createElement("p",null,"Right clicking places an X mark. X marks are for labelling tiles where you know there is no track."),r.a.createElement("p",null,"Pressing both mouse buttons at the same time places a dot mark. Dot marks are for labelling tiles where you know there is a track but are not sure which type."),r.a.createElement("p",null,"Holding down a mouse button and dragging over other tiles will place multiple tracks/markers."))),r.a.createElement(st,e))},cn=(n(24),function(e){var t=Object(a.useState)(!1),n=Object(l.a)(t,2),c=n[0],o=n[1],u={position:"absolute",height:"1.5rem",width:"1.5rem",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #444",backgroundColor:"white",borderRadius:"100%",zIndex:"-1",opacity:"0",transition:"0.5s",transform:"translate(".concat(67.5*(e.gameState.difficulty-3),"%, 100%)")},s={transform:"translate(".concat(67.5*(e.gameState.difficulty-3),"%, 120%)"),opacity:"1",transition:"1s"},f=c?Object(i.a)({},u,{},s):u;return r.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement("input",{className:"difficultySlider",onChange:function(t){return e.setGameState(Object(i.a)({},e.gameState,{difficulty:parseInt(t.target.value)}))},type:"range",min:"1",max:"5",value:e.gameState.difficulty,style:{width:"".concat(5,"rem")},onMouseOver:function(){return o(!0)},onMouseLeave:function(){return o(!1)}}),r.a.createElement("div",{className:"difficultyLabel",style:f},e.gameState.difficulty))}),on=function(){for(var e=[],t=0;t<3;t++){var n=6+2*t;e.push({display:"".concat(n,"x").concat(n),value:n})}return e},ln=function(e){return Object(a.useEffect)((function(){e.setGameState(Object(i.a)({},e.gameState,{seed:H()}))}),[]),r.a.createElement("div",{className:"menu startMapScreen"},r.a.createElement("div",{className:"startMapOptionsContainer"},r.a.createElement("p",{className:"startMapOptionLabel",key:"Map Size Label"},"Map Size"),r.a.createElement(lt,{key:"selectMapSize",style:{width:"3rem",height:"2rem",textAlign:"center",padding:"0 1.25rem 0 0.5rem"},options:on(),className:"mapSizeOption",placeholder:"".concat(e.gameState.size,"x").concat(e.gameState.size),onHover:function(){return null},onChange:function(t){e.setGameState(Object(i.a)({},e.gameState,{size:t.value}))}}),r.a.createElement("p",{className:"startMapOptionLabel",key:"Map Seed Label"},"Map Seed"),r.a.createElement("div",{className:"mapSeedOptionRow"},r.a.createElement("input",{key:"mapSeedInput",type:"text",className:"mapSeedInput",id:"mapSeedInput",defaultValue:e.gameState.seed,onChange:function(t){return e.setGameState(Object(i.a)({},e.gameState,{seed:t.target.value}))},style:{width:"8rem",textAlign:"center"}}),r.a.createElement("div",{key:"rerollSeedBtn",className:"rerollSeedBtn",onClick:function(t){t.preventDefault(),e.setGameState(Object(i.a)({},e.gameState,{seed:H()}))}},r.a.createElement("span",{className:"diceSymbol"},"\u2684"))),r.a.createElement("p",{className:"startMapOptionLabel"},"Difficulty:"),r.a.createElement("div",{className:"startMapSliderRow"},r.a.createElement(cn,e),r.a.createElement("div",{className:"questionBox difficultyQuestionBox"},"?"),r.a.createElement("div",{className:"startOptionExplanation difficultyExplanation"},"Adjusts the amount of default tiles in game. Difficulty 3 ensures the absolute minimum amount of default tiles required for a map that has one definitive solution.",r.a.createElement("br",null),r.a.createElement("br",null),"Difficulties above 3 may require trial and error and will likely have multiple possible solutions (only one solution accepted).")),r.a.createElement("p",{className:"startMapOptionLabel"},"Theme Color:"),r.a.createElement("div",{className:"startMapSliderRow"},r.a.createElement("input",{className:"colorSlider",onChange:function(t){return e.setThemeColor(Object(i.a)({},e.themeColor,{selected:parseInt(t.target.value)}))},type:"range",min:0,max:e.themeColor.available.length-1,value:e.themeColor.selected,style:{width:"".concat(10,"rem")}}),r.a.createElement("div",{className:"colorDemoBox",style:{backgroundColor:e.themeColor.available[e.themeColor.selected]}})),r.a.createElement("div",{className:"startOptionOptionRow"},r.a.createElement("input",{type:"checkbox",className:"startOptionCheckbox",defaultChecked:!e.visualEffects,onChange:function(t){return e.setVisualEffects(!t.target.checked)}}),r.a.createElement("p",{className:"startOptionRowLabel"},"Disable Visual Effects"),r.a.createElement("div",{className:"questionBox visualEffectsQuestionBox"},"?"),r.a.createElement("div",{className:"startOptionExplanation visualEffectsExplanation"},"Disables the game background and win display visual effects.",r.a.createElement("br",null),r.a.createElement("br",null),"Can increase performance on old browsers/PCs.")),r.a.createElement(ze,{className:"generateMapBtn",key:"generateMapBtn",onClick:function(){e.generateMap()},text:"Generate Map"})),r.a.createElement(st,e))},un=function(e){return r.a.createElement("div",{className:"menu aboutScreen"},r.a.createElement("p",null,"This game was created with React."),r.a.createElement("p",null,r.a.createElement("a",{href:"https://github.com/morgan-sam/Train-Tracks-React"},"Source Code")),r.a.createElement("p",null,"Samuel Morgan - 2020"),r.a.createElement(st,e))},sn=function(e){return r.a.createElement("div",{className:"menu mainMenu",key:"mainMenuScreen"},r.a.createElement(ze,{className:"startGameBtn",key:"startGameBtn",onClick:function(){e.setCurrentScreen("startMap")},text:"Start Game"}),r.a.createElement(ze,{className:"loadSavedGameBtn",key:"loadSavedGameBtn",onClick:function(){e.setCurrentScreen("loadMap")},text:"Load Saved Map"}),r.a.createElement(ze,{className:"howToPlayPageBtn",key:"howToPlayPageBtn",onClick:Object(f.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setCurrentScreen("howToPlay");case 1:case"end":return t.stop()}}),t)}))),text:"How To Play"}),r.a.createElement(ze,{className:"aboutBtn",key:"aboutBtn",onClick:function(){e.setCurrentScreen("about")},text:"About"}))},fn=function(e){return r.a.createElement("div",{className:"screen",key:e.currentScreen},r.a.createElement("h1",{key:"title",className:"gameTitle"},"Train Tracks"),function(t){switch(t){case"mainMenu":return r.a.createElement(sn,e);case"startMap":return r.a.createElement(ln,e);case"loadMap":return r.a.createElement(mt,e);case"howToPlay":return r.a.createElement(rn,e);case"about":return r.a.createElement(un,e);case"game":return r.a.createElement(ot,e);default:return r.a.createElement(sn,e)}}(e.currentScreen))},mn=function(e){var t=A(e);return pn(t).toDataURL("image/png")},pn=function(e){var t=document.createElement("canvas");return t.width=e,t.height=e,t.context=hn(t),t.context=dn(t,e/3),t},hn=function(e){var t=e.getContext("2d");return t.fillStyle="white",t.fillRect(0,0,e.width,e.height),t},dn=function(e,t){var n=e.getContext("2d"),a=e.width/2,r=e.height/2;n.save(),n.beginPath(),n.arc(a,r,t,0,2*Math.PI,!0),n.clip(),n.clearRect(a-t,r-t,2*t,2*t),n.restore()},vn=function(e){var t=A(e);return bn(t).toDataURL("image/png")},bn=function(e){var t=document.createElement("canvas");return t.width=e,t.height=e,t.context=gn(t),t.context=yn(t),t},gn=function(e){var t=e.getContext("2d");return t.fillStyle="white",t.fillRect(0,0,e.width,e.height),t},yn=function(e){var t=e.getContext("2d"),n=e.width/2,a=e.height/2;t.save(),t.beginPath(),t.translate(n,a),t.rotate(45*Math.PI/180),t.rect(-2.5,-25,5,50),t.rotate(90*Math.PI/180),t.rect(-2.5,-25,5,50),t.clip(),t.translate(-n,-a),t.clearRect(0,0,e.width,e.height)},kn={size:8,seed:H(),difficulty:3,mapObject:null,active:!1,visualEffects:!0},En=function(){var e=Object(a.useState)({height:window.innerHeight,width:window.innerWidth}),t=Object(l.a)(e,2),n=(t[0],t[1]),c=Object(a.useState)(!1),o=Object(l.a)(c,2),u=o[0],s=o[1],f=Object(a.useState)(kn),m=Object(l.a)(f,2),p=m[0],h=m[1],d=Object(a.useState)("mainMenu"),v=Object(l.a)(d,2),b=v[0],g=v[1],y=Object(a.useState)(3.5),k=Object(l.a)(y,2),E=k[0],O=(k[1],Object(a.useState)({unknown:mn(E),cross:vn(E)})),w=Object(l.a)(O,2),x=w[0],S=(w[1],Object(a.useState)({available:Te(),selected:0})),C=Object(l.a)(S,2),T=C[0],j=C[1],M=Object(a.useState)(!0),N=Object(l.a)(M,2),R=N[0],z=N[1],L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p.seed,t={size:p.size,seed:e,difficulty:p.difficulty},n=$t(t);h(Object(i.a)({},p,{seed:e,mapObject:n,active:!0}))};Object(a.useEffect)((function(){null!==p.mapObject&&p.active&&g("game")}),[p.mapObject,p.active]),Object(a.useEffect)((function(){var e=document.getElementById("mapSeedInput");e&&(e.value=p.seed)}),[p.seed]);var B={currentScreen:b,setCurrentScreen:g,gameState:p,setGameState:h,inGameNewMap:function(){return L(H())},generateMap:L,quitGame:function(){g("mainMenu"),h(Object(i.a)({},p,{mapObject:null,seed:H(),active:!1}))},tileRemSize:E,railImages:x,themeColor:T,setThemeColor:j,visualEffects:R,setVisualEffects:z,mobileView:u},D=function(){n({height:window.innerHeight,width:window.innerWidth}),s(window.innerWidth<600)};return Object(a.useEffect)((function(){return window.addEventListener("resize",D),function(){return window.removeEventListener("resize",D)}})),Object(a.useEffect)((function(){return D()}),[]),r.a.createElement("div",{key:"app",className:"app"},r.a.createElement("div",{key:"screenContainer",className:"screenContainer"},r.a.createElement(fn,B)))};n(25),n(26);o.a.render(r.a.createElement(En,null),document.getElementById("root"))}],[[14,1,2]]]);
//# sourceMappingURL=main.57df904d.chunk.js.map