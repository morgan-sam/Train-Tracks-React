(this["webpackJsonptrain-tracks"]=this["webpackJsonptrain-tracks"]||[]).push([[0],[,,,,,,,function(e,t,n){e.exports=n.p+"static/media/curvedtrack.513c0cf6.png"},,,,,function(e,t,n){e.exports=n.p+"static/media/straighttrack.9d34a133.png"},,,,,,function(e,t,n){e.exports=n(39)},,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,,,function(e,t){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(15),o=n.n(c),i=n(1),l=n(4),u=n(2),s=n.n(u),f=n(5),m=(n(24),n(3)),p=function(e){return r.a.createElement("div",{className:"white-background",style:{position:"absolute",top:"0",left:"0",height:"100%",width:"100%",background:"white",zIndex:"-2"}})},h=function(e){return{"top-left":{top:"0",left:"0",borderWidth:"0 0 ".concat(e/2,"rem ").concat(e/2,"rem")},"top-right":{top:"0",left:"".concat(e/2,"rem"),borderWidth:"0 ".concat(e/2,"rem ").concat(e/2,"rem 0")},"bottom-left":{top:"".concat(e/2,"rem"),left:"0",borderWidth:"".concat(e/2,"rem 0 0 ").concat(e/2,"rem")},"bottom-right":{top:"".concat(e/2,"rem"),left:"".concat(e/2,"rem"),borderWidth:"".concat(e/2,"rem ").concat(e/2,"rem 0 0")}}},d=function(){return{top:{top:"25%",left:"50%"},left:{top:"50%",left:"25%"},bottom:{top:"75%",left:"50%"},right:{top:"50%",left:"75%"}}},v=function(e){var t=function(e,t){var n=h(e)[t];return Object(i.a)({},{zIndex:"1",opacity:"0",height:"0",width:"0",borderStyle:"solid",position:"absolute"},{},n)}(e.tileRemSize,e.corner);return r.a.createElement("div",{className:"cornerButton ".concat(e.corner),style:t})},b=function(e){var t=function(e,t){var n={opacity:"0",position:"absolute",height:"".concat(e/2*.707106781,"rem"),width:"".concat(e/2*.707106781,"rem"),zIndex:"1",WebkitTransform:"rotate(45deg) translate(-50%, -50%)",MozTransform:"rotate(45deg) translate(-50%, -50%)",OTransform:"rotate(45deg) translate(-50%, -50%)",msTransform:"rotate(45deg) translate(-50%, -50%)",transform:"rotate(45deg) translate(-50%, -50%)",transformOrigin:"top left"},a=d()[t];return Object(i.a)({},n,{},a)}(e.tileRemSize,e.edge);return r.a.createElement("div",{className:"axisButton ".concat(e.edge),style:t})},g=function(e){var t,n=(t=e.tileRemSize,{opacity:"0",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",height:"".concat(t/5*2,"rem"),width:"".concat(t/5*2,"rem"),zIndex:"1",borderRadius:"5rem"});return r.a.createElement("div",{className:"centreButton",style:n})},y=function(e){return[["top-left","top-right","bottom-left","bottom-right"].map((function(t){return r.a.createElement(v,{corner:t,key:t,tileRemSize:e.tileRemSize})})),["top","right","bottom","left"].map((function(t){return r.a.createElement(b,{edge:t,key:t,tileRemSize:e.tileRemSize})})),r.a.createElement(g,{key:e.x,tileRemSize:e.tileRemSize})]},k=n(7),E=n.n(k),O=n(12),S=n.n(O),x=function(e){var t,n;return 1===e.length&&(e[0]%2===0&&(t="vertical"),e[0]%2===1&&(t="horizontal"),n=t),2===e.length&&(e[0]%2===0&&e[1]%2===0&&(t="vertical"),e[0]%2===1&&e[1]%2===1&&(t="horizontal"),(0===e[0]&&1===e[1]||3===e[0]&&2===e[1])&&(t="bottomRightCorner"),(1===e[0]&&2===e[1]||0===e[0]&&3===e[1])&&(t="bottomLeftCorner"),(2===e[0]&&3===e[1]||1===e[0]&&0===e[1])&&(t="topLeftCorner"),(3===e[0]&&0===e[1]||2===e[0]&&1===e[1])&&(t="topRightCorner"),n=e[1]%2===0?"vertical":"horizontal"),[t,n]},w=function(e){var t;switch(e){case"vertical":t={trackType:S.a,trackRotation:0};break;case"horizontal":t={trackType:S.a,trackRotation:90};break;case"bottomLeftCorner":t={trackType:E.a,trackRotation:0};break;case"topLeftCorner":t={trackType:E.a,trackRotation:90};break;case"topRightCorner":t={trackType:E.a,trackRotation:180};break;case"bottomRightCorner":t={trackType:E.a,trackRotation:270};break;case"T":case"X":t={trackType:e,trackRotation:"none"};break;default:t={trackType:"none",trackRotation:"none"}}return t},T=function(e){var t;return e.target.classList.contains("axisButton")&&((e.target.classList.contains("top")||e.target.classList.contains("bottom"))&&(t="vertical"),(e.target.classList.contains("right")||e.target.classList.contains("left"))&&(t="horizontal")),e.target.classList.contains("cornerButton")&&(e.target.classList.contains("top-left")&&(t="topLeftCorner"),e.target.classList.contains("top-right")&&(t="topRightCorner"),e.target.classList.contains("bottom-left")&&(t="bottomLeftCorner"),e.target.classList.contains("bottom-right")&&(t="bottomRightCorner")),e.target.classList.contains("centreButton")&&(t="T"),t},C=function(e){return{minHeight:"".concat(e,"rem"),minWidth:"".concat(e,"rem"),display:"block",position:"relative",top:"0",left:"0",height:"".concat(e,"rem"),width:"".concat(e,"rem")}},j=function(e){var t,n,c,o=Object(a.useState)(null),i=Object(l.a)(o,2),u=i[0],s=i[1];function f(t){return{tile:[e.x,e.y],railType:T(t),tileClass:m(t),mouseButton:t.buttons}}function m(e){var t,n=e.currentTarget.className;return n.includes("mapTile")&&(t="mapTile"),n.includes("defaultTrack")&&(t="defaultTrack"),t}!e.trackData&&u&&(t=function(e,t){var n=w(e);return"T"!==n.trackType?{backgroundImage:"url(".concat(n.trackType,")"),transform:"rotate(".concat(n.trackRotation,"deg)"),opacity:.5}:{backgroundImage:"url(".concat(t,")"),opacity:1}}(u,e.railImages.unknown)),"mapTile"===e.className&&e.trackData&&(n=e.trackData,c=e.railImages,t="T"!==n.trackType&&"X"!==n.trackType?{backgroundImage:"url(".concat(n.trackType,")"),transform:"rotate(".concat(n.trackRotation,"deg)"),opacity:1}:"T"===n.trackType?{backgroundImage:"url(".concat(c.unknown,")"),opacity:1}:{backgroundImage:"url(".concat(c.cross,")"),opacity:1}),(e.trackData&&"defaultTrack"===e.className||e.trackData&&"completeTrack"===e.className)&&(t=function(e,t){return{backgroundImage:"url(".concat(e.trackType,")"),transform:"rotate(".concat(e.trackRotation,"deg)"),opacity:1,filter:t?"hue-rotate(200deg) saturate(10)":"none",transition:"filter 1s ease-in-out"}}(e.trackData,e.highlighted));var h=!0;return"mapTile"===e.className&&(e.trackData?h=1!==e.trackData.trackType.length:u&&(h="T"!==u)),r.a.createElement("div",{style:C(e.tileRemSize),className:"square ".concat(e.className),onContextMenu:function(e){return e.preventDefault()},onMouseOver:function(t){return function(t){var n=f(t);e.hoverStartEvent(n),0===t.buttons&&s(n.railType)}(t)},onMouseLeave:function(e){s(null)},onMouseDown:function(t){return function(t){var n=f(t);1===n.mouseButton&&e.leftClickEvent(n),2===n.mouseButton&&e.rightClickEvent(n),3===n.mouseButton&&e.bothClickEvent(n)}(t)},onMouseUp:function(t){return function(t){var n=f(t);0===t.button&&e.leftReleaseEvent(n),2===t.button&&e.rightReleaseEvent()}(t)}},r.a.createElement("div",{className:"tile-button-container",style:void 0},r.a.createElement(y,e)),r.a.createElement("div",{className:"tile-display",style:t},void 0),h&&r.a.createElement(p,e))},M=function(e){return r.a.createElement("div",{style:C(e.tileRemSize),className:"square",onContextMenu:function(e){return e.preventDefault()}},r.a.createElement("div",{style:{width:"100%",height:"100%",border:"1px solid black",display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement("p",{className:"boxLabel",style:function(e){switch(e){case"underfilled":return{WebkitTextFillColor:"white",WebkitTextStrokeColor:"black"};case"full":return{WebkitTextFillColor:"green",WebkitTextStrokeColor:"white"};case"overfilled":return{WebkitTextFillColor:"red",WebkitTextStrokeColor:"white"};default:return{WebkitTextFillColor:"white",WebkitTextStrokeColor:"black"}}}(e.fillState)},e.headerLabel)))},N=function(e){var t=Object(i.a)({},C(e.tileRemSize));return r.a.createElement("div",{style:t},r.a.createElement("div",{className:"tile-display",style:{border:"1px solid black",zIndex:"1"}}))},R=function(e){var t=Object(i.a)({},C(e.tileRemSize),{zIndex:"-2",opacity:"0"});return r.a.createElement("div",{style:t})},z=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},L=function(e,t){for(var n=-1,a=0;a<t.length;a++)B(e,t[a])&&(n=a);return n},B=function(e,t){var n=!1;return e.length===t.length&&(n=e.every((function(e,n){return e===t[n]}))),n},D=function(e){return Array.isArray(e)&&e.length>0},I=function(e){return e.filter((function(t,n){return n===L(t,e)}))},P=function(e){return e.filter((function(t,n){return n!==L(t,e)}))},A=function(e,t){return e.forEach((function(e){t=t.filter((function(t){return!B(t,e)}))})),t},W=function(){return Math.floor(Math.random()*Math.pow(10,15))},H=function(e){return e*parseFloat(getComputedStyle(document.documentElement).fontSize)},G=function(e,t){var n=t.filter((function(t){return B(e,t)}));return Boolean(n.length)},U=function(e){return e[z(0,e.length-1)]},V=function(e){var t=Math.floor(e.length/2);return e.slice(0,t)},q=function(e){var t=[];return e.tracks.forEach((function(e){e.defaultTrack&&t.push(e)})),t},F=function(e,t){var n=null;return t.forEach((function(t){t.tile[0]===e[0]&&t.tile[1]===e[1]&&(n=t.railType)})),n},X=function(e){return e.filter((function(e){return"X"!==e.railType})).length},J=function(e,t){return e.tracks.filter((function(e){var n=e.defaultTrack;return t.forEach((function(t){B(e.tile,t.tile)&&e.railType===t.railType&&(n=!0)})),n})).length},Q=function(e){function t(t,n,a,c){return r.a.createElement(j,Object.assign({className:"mapTile",tileRemSize:e.tileRemSize,railImages:e.railImages,key:t,x:t,y:n,mapSolutionVisible:c,trackData:a},e.activeMouseEventsObject))}var n=function(t,n,a,c,o){return r.a.createElement(j,Object.assign({className:"defaultTrack",tileRemSize:e.tileRemSize,key:t,x:t,y:n,highlighted:c,trackData:w(a)},o))};function a(t,a,c){var o,i=!1;return t.tracks.forEach((function(t){t.tile[0]===a&&t.tile[1]===c-1&&(o=t.railType,e.defaultTilesHighlighted&&t.defaultTrack&&(i=!0))})),o?function(t,a,r,c){return n(t,a,r,c,e.emptyMouseEventsObject)}(a,c-1,o,i):r.a.createElement(N,{key:a,tileRemSize:e.tileRemSize})}function c(a,r,c){var o=function(e,t,n){var a=null;return e.tracks.forEach((function(e){e.tile[0]===t&&e.tile[1]===n&&e.defaultTrack&&(a=e.railType)})),a}(a,r,c-1);return o?function(t,a,r,c){return n(t,a,r,c,e.activeMouseEventsObject)}(r,c-1,o,e.defaultTilesHighlighted):function(n,a){var r;return e.placedTracks.forEach((function(e){e.tile[0]===n&&e.tile[1]===a-1&&(r=w(e.railType))})),t(n,a-1,r||null)}(r,c)}function o(t,n){var a="underfilled",r=q(e.trainTrackMap),c="x"===t?0:1,o=r.filter((function(e){return e.tile[c]===n})).length,i=e.trainTrackMap.tracks.filter((function(e){return e.tile[c]===n})).length;return e.placedTracks.forEach((function(e){e.tile[c]===n&&"X"!==e.railType&&o++})),i<o?a="overfilled":i===o&&(a="full"),a}for(var i=[],l=function(t){i.push(r.a.createElement("div",{className:"mapRow",key:t},Object(m.a)(Array(e.mapWidth+1)).map((function(n,i){return 0===t?function(t,n,a){var c=t.headerLabels.x[n],i=e.gameComplete?"full":o("x",n);return r.a.createElement(M,{key:n,x:n,y:a-1,headerLabel:c,fillState:i,tileRemSize:e.tileRemSize})}(e.trainTrackMap,i,t):i===e.mapWidth?function(t,n,a){var c=t.headerLabels.y[a-1],i=e.gameComplete?"full":o("y",a-1);return r.a.createElement(M,{key:n,x:n,y:a-1,headerLabel:c,fillState:i,tileRemSize:e.tileRemSize})}(e.trainTrackMap,i,t):e.mapVisible?function(t,n,r){return e.gameComplete||e.mapSolutionVisible?a(t,n,r):c(t,n,r)}(e.trainTrackMap,i,t):r.a.createElement(R,{key:i,tileRemSize:e.tileRemSize})}))))},u=0;u<e.mapHeight+1;u++)l(u);return i},Y=function(e,t){var n=K(e,t.mapTracks),a=Z(n,t.placedTracks);return[].concat(Object(m.a)(n),Object(m.a)(a))},K=function(e,t){return e.filter((function(e){return 0===t.filter((function(t){return B(e.tile,t.tile)&&t.defaultTrack})).length}))},Z=function(e,t){var n=[];return t.forEach((function(t){var a=!1;e.forEach((function(e){B(t.tile,e.tile)&&(a=!0)})),a||n.push(t)})),n},$=function(e,t){var n,a,r,c=(r=t,[(a=e)[0]-r[0],a[1]-r[1]]);return B(c,[0,-1])&&(n=0),B(c,[1,0])&&(n=1),B(c,[0,1])&&(n=2),B(c,[-1,0])&&(n=3),n};var _=function(e,t){for(var n=[],a=function(a){var r=2*Math.ceil(a%3/2)+1,c=t.filter((function(t){return t[a%2]===e[a%2]})).filter((function(t){return t[(a+1)%2]*-r<e[(a+1)%2]*-r}));n.push(c)},r=0;r<4;r++)a(r);return n},ee=function(e,t){var n=[];n.push(function(e,t){var n=function(e,t){var n=t.mapWidth,a=t.mapHeight,r=[];0===e[0]&&r.push(1);0===e[1]&&r.push(2);e[0]===n-1&&r.push(3);e[1]===a-1&&r.push(0);return r}(e,t);return n[z(0,n.length-1)]}(e[0],t));for(var a=0;a<e.length-1;a++){var r=$(e[a+1],e[a]);n.push(r)}return n.push(function(e,t){var n=function(e,t){var n=t.mapWidth,a=t.mapHeight,r=[];0===e[0]&&r.push(3);0===e[1]&&r.push(0);e[0]===n-1&&r.push(1);e[1]===a-1&&r.push(2);return r}(e,t);return n[z(0,n.length-1)]}(e[e.length-1],t)),n};var te=function(e){var t=pe(e);return x(t).map((function(t,n){return{tile:e[n+1],railType:t}}))},ne=function(e,t){var n=fe(e[0],t);return ue(e,t)?ae(e,t):D(n)?se(e,n):te([null].concat(Object(m.a)(e)))},ae=function(e,t){var n=oe(e,t),a=re(n,e);return ce(a).map((function(t,n){return{tile:e[n],railType:t}}))},re=function(e,t){var n=function(e){for(var t=[],n=0;n<e.length-1;n++){var a=$(e[n+1],e[n]);t.push(a)}return t}(t)[0],a=[];if(e[0]){var r=(e[0].position+2)%4;a.push(r)}else a.push(n);return a.push(n),e[1]?a.push(e[1].position):a.push(n),a},ce=function(e){for(var t=[],n=0;n<e.length-1;n++){var a=[e[n],e[n+1]],r=x(a)[0];t.push(r)}return t},oe=function(e,t){var n=e.slice().reverse();return[ie(e,t),ie(n,t)]},ie=function(e,t){var n=le(e[0],t);if(n){var a=fe(e[0],t),r=(a=a.filter((function(t){return!B(t.tile,e[1])}))).filter((function(e){return function(e,t){switch(e){case 0:if(("vertical"===t[0]||"topLeftCorner"===t[0]||"topRightCorner"===t[0])&&"vertical"===t[1]||"bottomLeftCorner"===t[1]||"bottomRightCorner"===t[1])return!0;break;case 1:if(("horizontal"===t[0]||"topRightCorner"===t[0]||"bottomRightCorner"===t[0])&&("horizontal"===t[1]||"topLeftCorner"===t[1]||"bottomLeftCorner"===t[1]))return!0;break;case 2:if(("vertical"===t[0]||"bottomLeftCorner"===t[0]||"bottomRightCorner"===t[0])&&"vertical"===t[1]||"topLeftCorner"===t[1]||"topRightCorner"===t[1])return!0;break;case 3:if(("horizontal"===t[0]||"topLeftCorner"===t[0]||"bottomLeftCorner"===t[0])&&("horizontal"===t[1]||"topRightCorner"===t[1]||"bottomRightCorner"===t[1]))return!0}return!1}(e.position,[n,e.railType])}));return U(r)}return null},le=function(e,t){var n=t.tracksOnMap.filter((function(t){return B(e,t.tile)}));return D(n)?n[0].railType:null},ue=function(e,t){var n=t.tracksOnMap.filter((function(t){return B(t.tile,e[0])})).length,a=t.tracksOnMap.filter((function(t){return B(t.tile,e[1])})).length;return Boolean(n+a>0)},se=function(e,t){var n=t.map((function(e){return e.tile})),a=[U(n),e[0],e[1]];return te(a)},fe=function(e,t){var n=function(e,t){var n=function(e,t){var n=[];return e[1]>0&&n.push({tile:[e[0],e[1]-1],position:0}),e[0]<t.x&&n.push({tile:[e[0]+1,e[1]],position:1}),e[1]<t.y&&n.push({tile:[e[0],e[1]+1],position:2}),e[0]>0&&n.push({tile:[e[0]-1,e[1]],position:3}),n}(e,t.axisMax),a=t.tracksOnMap.map((function(e){return e.tile}));return n.filter((function(e){return G(e.tile,a)}))}(e,t);return me(n,t.tracksOnMap).filter((function(e){return t=e.position,n=e.railType,0===t&&("vertical"===n||"bottomLeftCorner"===n||"bottomRightCorner"===n)||3===t&&("horizontal"===n||"bottomRightCorner"===n||"topRightCorner"===n)||2===t&&("vertical"===n||"topLeftCorner"===n||"topRightCorner"===n)||1===t&&("horizontal"===n||"topLeftCorner"===n||"bottomLeftCorner"===n);var t,n}))},me=function(e,t){var n=[];return e.forEach((function(e){t.forEach((function(t){B(e.tile,t.tile)&&n.push({tile:t.tile,railType:t.railType,position:e.position})}))})),n},pe=function(e){for(var t=[],n=0;n<e.length-1;n++)null!==e[n]&&null!==e[n+1]&&t.push($(e[n+1],e[n]));return t},he=["#ff0000","#ffa500","#ffff00","#008000","#0000ff","#4b0082","#ee82ee"],de=function(){var e=100,t=z(e,255);t>255-e/2?e*=.8:e/=.8;var n=z(e,255);n>255-e/2?e*=.8:e/=.8;var a=z(e,255);return"rgb(".concat([t,n,a],")")},ve=function(e,t){return ye({colorOneArray:be(e),colorTwoArray:[255,255,255],numberOfShades:Math.ceil(t)}).map((function(e){return ge(e)}))},be=function(e){return e.replace("#","").match(/.{1,2}/g).map((function(e){return parseInt(Number("0x".concat(e)),10)}))},ge=function(e){return"#"+e.map((function(e){var t=e.toString(16);return 1===t.length?"0"+t:t})).join("")};function ye(e){for(var t=e.colorOneArray,n=e.numberOfShades,a=[],r=function(e){var t=e.colorOneArray,n=e.colorTwoArray,a=e.numberOfShades;return t.map((function(e,t){return(n[t]-e)/(a-1)}))}(e),c=function(e){var n=t.map((function(t,n){return Math.floor(t+e*r[n])}));a.push(n)},o=0;o<n;o++)c(o);return a}var ke=function(){for(var e,t,n=[],a=0;a<he.length-1;a++){var r=(e=he[a+1],t=100,ye({colorOneArray:be(he[a]),colorTwoArray:be(e),numberOfShades:Math.ceil(t)}).map((function(e){return ge(e)})));n.push(r)}return n=n.flat(),n},Ee=function(e){var t=e.themeColor.available[e.themeColor.selected],n=[];if(e.visualEffects)for(var a=ve(t,21),c=0;c<20;c++){var o={backgroundColor:a[c],animation:"spin ".concat(15+.25*(c+1),"s infinite linear"),height:"".concat(100-4*c,"%"),width:"".concat(100-4*c,"%")};n.push(r.a.createElement("div",{key:c,className:"mapBackgroundShape",style:o}))}else{var i=ve(t,10)[6];n.push(r.a.createElement("div",{style:{width:"100%",height:"100%",backgroundColor:i}}))}return r.a.createElement("div",{className:"mapBackgroundContainer"},n)},Oe=function(e){var t=Object(a.useState)([]),n=Object(l.a)(t,2),c=n[0],o=n[1],i=Object(a.useRef)([null,null,null]),u=Object(a.useRef)(),p=Object(a.useRef)([null,null]),h=Object(a.useRef)();function d(e){var t=e.tile,n=e.mouseButton,a=e.tileClass;3===n&&"mapTile"===a&&v(t,"T")}function v(e,t){b([{tile:e,railType:t}])}function b(e){return g.apply(this,arguments)}function g(){return(g=Object(f.a)(s.a.mark((function t(n){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=Y(n,{mapTracks:e.trainTrackMap.tracks,placedTracks:e.placedTracks}),t.next=3,e.setPlacedTracks(a);case 3:return t.next=5,E();case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function y(e){return k.apply(this,arguments)}function k(){return(k=Object(f.a)(s.a.mark((function t(n){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.placedTracks.filter((function(e){return!(e.tile[0]===n[0]&&e.tile[1]===n[1])})),t.next=3,e.setPlacedTracks(a);case 3:return t.next=5,E();case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var E=function(){(function(e,t){var n=J(e,t),a=q(e).length,r=X(t);return n===e.tracks.length&&e.tracks.length===r+a})(e.trainTrackMap,e.placedTracks)&&e.setGameCompleteState(!0)};Object(a.useEffect)((function(){E()}),[e.placedTracks]),Object(a.useEffect)((function(){var t=e.trainTrackMap.tracks.filter((function(e){return e.defaultTrack})),n=e.placedTracks.filter((function(e){return"X"!==e.railType}));o({tracksOnMap:[].concat(Object(m.a)(t),Object(m.a)(n)),axisMax:{x:e.mapWidth,y:e.mapHeight}})}),[e.placedTracks]);var O={leftClickEvent:e.controlsActive?function(e){i.current=[null,null,e.tile]}:function(){return null},rightClickEvent:e.controlsActive?function(t){!function(t){var n=F(t.tile,e.placedTracks);u.current=null===n?"X":"DELETE"}(t),function(t){"mapTile"===t.tileClass&&(F(t.tile,e.placedTracks)?y(t.tile):v(t.tile,u.current))}(t)}:function(){return null},bothClickEvent:e.controlsActive?function(e){d(e)}:function(){return null},leftReleaseEvent:e.controlsActive?function(e){1===i.current.filter((function(e){return e})).length&&"mapTile"===e.tileClass&&(v(e.tile,e.railType),i.current=[])}:function(){return null},rightReleaseEvent:e.controlsActive?function(){u.current=void 0}:function(){return null},hoverStartEvent:e.controlsActive?function(e){(function(e){return!B(e.tile,p.current)})(e)&&(function(e){h.current=p.current,p.current=e.tile}(e),1===e.mouseButton&&function(){var e=!0;p.current[0]>h.current[0]+1&&(e=!1);p.current[0]<h.current[0]-1&&(e=!1);p.current[1]>h.current[1]+1&&(e=!1);p.current[1]<h.current[1]-1&&(e=!1);return e}()&&function(e){if(D(i.current)){i.current=(t=i.current,n=[e.tile],t.slice(n.length).concat(n)),b(function(e,t){var n=e.slice(1);return null===e[0]?ne(n,t):te(e)}(i.current,c))}var t,n}(e),2===e.mouseButton&&function(e){"X"===u.current?"mapTile"===e.tileClass&&v(e.tile,u.current):"DELETE"===u.current&&y(e.tile)}(e),3===e.mouseButton&&function(e){d(e)}(e))}:function(){return null}};return r.a.createElement("div",{className:"map"},r.a.createElement(Q,Object.assign({},e,{activeMouseEventsObject:O,emptyMouseEventsObject:{leftClickEvent:function(){return null},rightClickEvent:function(){return null},bothClickEvent:function(){return null},leftReleaseEvent:function(){return null},rightReleaseEvent:function(){return null},hoverStartEvent:function(){return null},dragArray:null,rightClickDragValue:null}})),r.a.createElement(Ee,{themeColor:e.themeColor,visualEffects:e.visualEffects}))},Se=function(e){var t=e.className,n=e.onClick,c=e.text,o=e.bounceDelay,u=void 0===o?200:o,s=e.clickDelay,f=void 0===s?500:s,m=Object(a.useState)(!1),p=Object(l.a)(m,2),h=p[0],d=p[1],v=Object(a.useState)(!1),b=Object(l.a)(v,2),g=b[0],y=b[1],k=Object(a.useRef)(),E=Object(a.useRef)(),O=function(e){return{btnDefaultStyle:{position:"relative",overflow:"hidden",cursor:"pointer",background:"none",zIndex:"0",borderRadius:"1rem",border:"1px #ccc solid",outline:"none",transition:"0.3s",top:"0px",boxShadow:"0px 5px 0px 2px #eee"},btnPressedStyle:{transition:"0.1s",top:"10px",boxShadow:"none"},rectangleStyle:{top:"0%",left:"-30%",height:"350%",width:"70rem",position:"absolute",zIndex:"-1",borderRadius:"50rem"},textStyle:{zIndex:"1",color:e?"white":"black",transition:e?"color 1s cubic-bezier(0,2.53,.53,-1.51)":"color 0s"},whiteBackground:{zIndex:"-2",top:"0",left:"0",position:"absolute",height:"100%",width:"100%",backgroundColor:"white"}}}(h),S=O.btnDefaultStyle,x=O.btnPressedStyle,w=O.rectangleStyle,T=O.textStyle,C=O.whiteBackground,j=function(e){for(var t=[],n=ve("#5bb1cd",1.2*e),a=ve("#800080",1.2*e),c=0;c<e;c++){var o={background:"linear-gradient(1turn,".concat(n[n.length-c-1],",").concat(a[a.length-c-1],")"),transform:h?"rotate(".concat(2*c-5,"deg) skewY(0deg)"):"rotate(".concat(30+2*c,"deg) skewY(45deg)"),transition:h?"all ".concat(1.5+.1*c,"s ").concat("cubic-bezier(0,1.84,0,.32)"):"all ".concat(3,"s ").concat("cubic-bezier(0,1.84,0,.32)")};t.push(r.a.createElement("div",{key:c,style:Object(i.a)({},w,{},o),className:"rectangle",id:"rec".concat(c)}))}return t}(5);var M=g?Object(i.a)({},S,{},x):S;return r.a.createElement("button",{style:M,className:t,onMouseOver:function(){return d(!0)},onMouseLeave:function(){return g?null:d(!1)},onClick:function(){y(!0),k.current=setTimeout((function(){return y(!1),clearTimeout(k.current)}),u),E.current=setTimeout((function(){return n(),clearTimeout(E.current)}),f)}},j,r.a.createElement("div",{style:T},c),r.a.createElement("div",{style:C}))},xe=function(e){var t=e.mapTracks,n=e.placedTracks,c=e.setGameWinState,o=e.setPlacedTracks,l=e.setDisplay,u=e.display,p=e.seed,h=e.inGameNewMap,d=e.quitGame,v=Object(a.useRef)(null);return r.a.createElement("div",{className:"inGameOptions"},r.a.createElement("div",{className:"topRowInGameButtons"},r.a.createElement(Se,{key:"addHintTrackButton",onClick:function(){var e=function(e,t){if(!e)return t;var n=t.filter((function(t){return!B(e.tile,t.tile)}));return[].concat(Object(m.a)(n),[e])}(function(e,t){var n=t.map((function(e){return e.tile})),a=t.map((function(e){return e.railType})),r=Object(m.a)(e).filter((function(e){if(e.defaultTrack)return!1;var t=L(e.tile,n);return-1===t||a[t]!==e.railType}));return D(r)?U(r):null}(t,n),n);o(e)},text:"Add Hint Track",clickDelay:50}),r.a.createElement(Se,{key:"highlightDefaultTilesBtn",onClick:function(){return l(Object(i.a)({},u,{defaultHighlights:!u.defaultHighlights}))},text:u.defaultHighlights?"Hide Default Tiles":"Show Default Tiles",clickDelay:50}),r.a.createElement(Se,{key:"showMapSolutionBtn",onClick:function(){return l(Object(i.a)({},u,{solutionVisible:!u.solutionVisible}))},text:u.solutionVisible?"Hide Map Solution":"Show Map Solution",clickDelay:200})),r.a.createElement("div",{className:"bottomRowInGameButtons"},r.a.createElement(Se,{key:"resetMapBtn",onClick:Object(f.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c(!1),o([]),l(Object(i.a)({},u,{winPopUp:!1,solutionVisible:!1}));case 3:case"end":return e.stop()}}),e)}))),text:"Reset Map",clickDelay:100}),r.a.createElement(Se,{key:"saveMapBtn",onClick:function(){l(Object(i.a)({},u,{savePopUp:!0,winPopUp:!1}))},text:"Save Map",clickDelay:100}),r.a.createElement("div",{className:"mapSeedOptionContainer"},r.a.createElement(Se,{style:{zIndex:"4"},className:"mapSeedBtn",key:"mapSeedBtn",onClick:function(){v.current.select(),document.execCommand("copy")},text:"\ud83c\udf31"}),r.a.createElement("div",{className:"mapSeedExplanation"},r.a.createElement("span",null,"Copy map seed to clipboard")),r.a.createElement("textarea",{ref:v,readOnly:!0,unselectable:"on",style:{position:"absolute",top:0,left:0,opacity:0,width:0,height:0,resize:"none",cursor:"default"},value:p})),r.a.createElement(Se,{key:"newMapBtn",onClick:function(){c(!1),o([]),l(Object(i.a)({},u,{winPopUp:!1,solutionVisible:!1})),h()},text:"New Map",clickDelay:200}),r.a.createElement(Se,{key:"quitBtn",onClick:function(){return d()},text:"Quit Game"})))},we=function(){var e=Object(f.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=JSON.parse(window.localStorage.getItem("savedMaps")),!D(n)){e.next=7;break}return a=[].concat(Object(m.a)(n),[t]),e.next=5,window.localStorage.setItem("savedMaps",JSON.stringify(a));case 5:e.next=9;break;case 7:return e.next=9,window.localStorage.setItem("savedMaps",JSON.stringify([t]));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Te=function(){var e=JSON.parse(window.localStorage.getItem("savedMaps"));return D(e)||(e=[]),e},Ce=function(){var e=Object(f.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Te(),a=n.filter((function(e){return e.seed!==t})),e.next=4,window.localStorage.setItem("savedMaps",JSON.stringify(a));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),je=function(){var e=Object(f.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.localStorage.setItem("savedMaps",JSON.stringify([]));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Me=function(e){var t=e.display,n=e.setDisplay,c=e.gameState,o=Object(a.useState)(null),u=Object(l.a)(o,2),s=u[0],f=u[1];return r.a.createElement("div",{key:"saveMapDisplay",className:"saveMapDisplay",onContextMenu:function(e){return e.preventDefault()}},r.a.createElement("p",null,"Enter a name to save map as:"),r.a.createElement("button",{key:"closeSaveMapDisplay",className:"closePopUpWindow",onClick:function(){return n(Object(i.a)({},t,{savePopUp:!1}))}},"X"),r.a.createElement("input",{key:"saveNameInputBox",className:"saveNameInputBox",onChange:function(e){return f(e.target.value)}}),r.a.createElement(Se,{key:"confirmSaveMapBtn",className:"confirmSaveMapBtn",onClick:function(){we(Object(i.a)({name:s},c)),f(null),n(Object(i.a)({},t,{savePopUp:!1}))},text:"Save Map"}))},Ne=(n(25),function(e){var t=[],n=e.themeColor.available[e.themeColor.selected];if(e.visualEffects)for(var a=0;a<300;a++){var c=de(),o=e.visualEffects?z(-20,100):50,i=e.visualEffects?z(0,1e4):0,l={left:"".concat(o,"%"),backgroundColor:c,color:c,opacity:0,animationDelay:"".concat(i,"ms")};t.push(r.a.createElement("div",{key:a,className:"balloon",style:l},r.a.createElement("div",{key:"balloonString".concat(a),className:"balloonString"},"\u0601")))}else{var u=ve(n,10)[8];t.push(r.a.createElement("div",{style:{width:"100%",height:"100%",backgroundColor:u}}))}return t}),Re=function(e){var t=e.display,n=e.setDisplay,a=e.visualEffects,c=e.themeColor;return r.a.createElement("div",{key:"gameWinDisplay",className:"winDisplay",onContextMenu:function(e){return e.preventDefault()}},r.a.createElement("h2",{key:"winText",className:"winText"},"You Win!"),r.a.createElement("button",{key:"closeWinDisplay",className:"closePopUpWindow",onClick:function(){return n(Object(i.a)({},t,{winPopUp:!1}))}},"X"),r.a.createElement("div",{key:"balloonContainer",className:"balloonContainer"},r.a.createElement(Ne,{visualEffects:a,themeColor:c})))},ze=function(){var e=Object(f.a)(s.a.mark((function e(t,n){var a,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:!0,complete:n,dimensions:250,cutOut:!1},e.next=3,Ie(t,a);case 3:return r=e.sent,c=r.toDataURL("image/png"),e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Le=function(){var e=Object(f.a)(s.a.mark((function e(t,n){var a,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:!1,complete:!1,dimensions:H(n)*t.headerLabels.x.length,cutOut:!0},e.next=3,Ie(t,a);case 3:return r=e.sent,c=r.toDataURL("image/png"),e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Be=function(){var e=Object(f.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Pe(S.a),Pe(E.a)]);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),De=function(){var e=Object(f.a)(s.a.mark((function e(t,n){var a,r,c,o,i,u,f,m,p,h,d,v;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=document.createElement("canvas"),r=a.getContext("2d"),a.width=n.dimensions,a.height=n.dimensions,c=t.headerLabels.x.length,o=t.headerLabels.y.length,i=c+n.headers,u=o+n.headers,f=a.width/i,m=a.height/u,e.next=12,Be();case 12:return p=e.sent,h=Object(l.a)(p,2),d=h[0],v=h[1],e.abrupt("return",{canvas:a,context:r,iconTile:{width:f,height:m},map:{width:c,height:o},gridMap:{width:i,height:u},trackImage:{straight:d,curved:v},options:n});case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ie=function(){var e=Object(f.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,De(t,n);case 2:return(a=e.sent).context=Ae(a),a.context=We(t,a),a.context=He(t,a),n.cutOut&&(a.context=Ue(a)),e.abrupt("return",a.canvas);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Pe=function(e){return new Promise((function(t,n){var a=new Image;a.onload=function(){return t(a)},a.onerror=n,a.src=e}))},Ae=function(e){var t=e.canvas,n=e.context;return n.fillStyle="white",n.fillRect(0,0,t.width,t.height),n},We=function(e,t){var n=t.options,a=t.context;return e.tracks.forEach((function(e){(n.complete||e.defaultTrack)&&(a="horizontal"===e.railType||"topLeftCorner"===e.railType||"topRightCorner"===e.railType||"bottomRightCorner"===e.railType?function(e,t){var n=t.context,a=t.options,r=t.iconTile,c=r.width,o=r.height,i=t.trackImage,l=i.straight,u=i.curved,s=function(e){var t;switch(e){case"horizontal":case"topLeftCorner":t=90;break;case"topRightCorner":t=180;break;case"bottomRightCorner":t=270;break;default:t=0}return t}(e.railType);return n.save(),n.translate(e.tile[0]*c+c/2,(e.tile[1]+a.headers)*o+o/2),n.rotate(s*(Math.PI/180)),n.drawImage("vertical"===e.railType||"horizontal"===e.railType?l:u,-c/2,-o/2,c,o),n.restore(),n}(e,t):function(e,t){var n=t.context,a=t.options,r=t.iconTile,c=r.width,o=r.height,i=t.trackImage,l=i.straight,u=i.curved;return n.drawImage("vertical"===e.railType||"horizontal"===e.railType?l:u,e.tile[0]*c,(e.tile[1]+a.headers)*o,c,o),n}(e,t))})),a};function He(e,t){for(var n=t.context,a=t.gridMap,r=t.iconTile,c=t.options,o=t.map,i=0;i<a.width*a.height;i++){var l=i%a.width,u=Math.floor(i/a.height);if(c.headers&&(l===o.width||0===u))n=Ge({tile:{x:l,y:u},mapObject:e},t);n.fillStyle="black",n.strokeRect(l*r.width,u*r.height,r.width,r.height)}return n}function Ge(e,t){var n=t.context,a=t.map.width,r=e.tile,c=r.x,o=r.y;return n=function(e,t){var n=t.context,a=t.iconTile,r=e.x,c=e.y;return n.fillStyle="#FFE4B5",n.fillRect(r*a.width,c*a.height,a.width,a.height),n}(e.tile,t),(0===o&&c!==a||c===a&&0!==o)&&(n=function(e,t){var n=t.context,a=t.iconTile,r=e.tile,c=r.x,o=r.y;return n.fillStyle="black",n.font="1.5rem Georgia",n.textAlign="center",n.textBaseline="middle",n.fillText(function(e,t){var n=t.map.width,a=e.mapObject,r=e.tile,c=r.x,o=r.y,i="ERROR";0===o&&c!==n&&(i=a.headerLabels.x[c]);c===n&&0!==o&&(i=a.headerLabels.y[o-1]);return i}(e,t),(c+.5)*a.width,(o+.5)*a.height),n}(e,t)),n}function Ue(e){var t=e.context,n=e.iconTile,a=e.map;return t.clearRect((a.width+1)*n.width/2-125,(a.height-1)*n.height/2-75,250,150),t.strokeRect((a.width+1)*n.width/2-125,(a.height-1)*n.height/2-75,250,150),t}var Ve=n(10),qe=function(e,t){var n;return n={display:"inline-block",position:"relative",zIndex:"0",marginBottom:"1rem",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",boxSizing:"border-box"},Object(Ve.a)(n,"position","relative"),Object(Ve.a)(n,"width","".concat((e+1)*t,"rem")),Object(Ve.a)(n,"height","".concat((e+1)*t,"rem")),n},Fe=function(e){var t=Object(a.useState)(!1),n=Object(l.a)(t,2),c=n[0],o=n[1],u=Object(a.useState)([]),m=Object(l.a)(u,2),p=m[0],h=m[1],d=Object(a.useState)({winPopUp:!1,savePopUp:!1,saveBoxCutOut:null,defaultHighlights:!1,solutionVisible:!1}),v=Object(l.a)(d,2),b=v[0],g=v[1];return Object(a.useEffect)((function(){function t(){return(t=Object(f.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!b.savePopUp){t.next=13;break}return t.t0=g,t.t1=i.a,t.t2={},t.t3=b,t.next=7,Le(e.gameState.mapObject,e.tileRemSize);case 7:t.t4=t.sent,t.t5={saveBoxCutOut:t.t4},t.t6=(0,t.t1)(t.t2,t.t3,t.t5),(0,t.t0)(t.t6),t.next=14;break;case 13:g(Object(i.a)({},b,{saveBoxCutOut:null}));case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[b.savePopUp]),r.a.createElement("div",null,r.a.createElement("div",{style:qe(e.gameState.size,e.tileRemSize)},b.winPopUp&&r.a.createElement(Re,{display:b,setDisplay:g,visualEffects:e.visualEffects,themeColor:e.themeColor}),b.savePopUp&&r.a.createElement(Me,{display:b,setDisplay:g,gameState:e.gameState}),r.a.createElement(Oe,{key:e.mapSeed,className:"gameMap",tileRemSize:e.tileRemSize,defaultTilesHighlighted:b.defaultHighlights,mapSolutionVisible:b.solutionVisible,trainTrackMap:e.gameState.mapObject,mapHeight:e.gameState.size,mapWidth:e.gameState.size,setGameCompleteState:function(e){o(e),g(Object(i.a)({},b,{winPopUp:e}))},gameComplete:c,controlsActive:!b.savePopUp,mapVisible:!b.saveBoxCutOut,setPlacedTracks:function(e){return h(e)},placedTracks:p,railImages:e.railImages,themeColor:e.themeColor,visualEffects:e.visualEffects}),r.a.createElement("img",{alt:"",draggable:"false",src:b.saveBoxCutOut,className:"saveBoxMapCutout",style:{position:"absolute",top:"".concat(e.tileRemSize,"rem"),left:"0px",border:b.saveBoxCutOut?"1px solid black":"none"}})),r.a.createElement(xe,{setGameWinState:o,placedTracks:p,setPlacedTracks:h,setDisplay:g,mapTracks:e.gameState.mapObject.tracks,display:b,seed:e.gameState.seed,inGameNewMap:e.inGameNewMap,quitGame:e.quitGame,visualEffects:e.visualEffects}))},Xe=n(17),Je=function(e){var t=e.style,n=e.placeholder,c=e.options,o=e.onChange,u=e.onHover,s=e.className,f=Object(a.useState)(!1),m=Object(l.a)(f,2),p=m[0],h=m[1],d=Object(a.useState)(n),v=Object(l.a)(d,2),b=v[0],g=v[1],y=Object(a.useState)(null),k=Object(l.a)(y,2),E=k[0],O=k[1],S=Object(i.a)({background:"#fff",border:"1px #aaa solid",lineHeight:t.height},t,{position:"relative",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",borderRadius:p?"1rem 1rem 0 0":"1rem",boxShadow:"0px 5px 0px 2px #eee",cursor:"pointer"}),x=Object(i.a)({},S,{borderTop:"none"});Object(a.useEffect)((function(){return p?document.addEventListener("mousedown",w):document.removeEventListener("mousedown",w),function(){return document.removeEventListener("mousedown",w)}}));var w=function(e){"dropdown"!==e.target.className&&(h(!1),u(!1))},T=function(e,t){o(e,t),h(!1)},C=function(e){u(e)};return r.a.createElement("div",{className:s},r.a.createElement("div",{className:"dropdown",style:Object(i.a)({},S,{backgroundColor:"#fff"}),onMouseDown:function(e){1===e.buttons&&h(!p)},onContextMenu:function(e){return e.preventDefault()}},b,r.a.createElement("span",{style:{fontSize:"0.75rem",position:"absolute",right:"5%"}},"\u25bc")),r.a.createElement("div",{style:{position:"absolute"}},p?function(e){var t=[];return e.forEach((function(n,a){t.push(r.a.createElement("div",{className:"dropdown",style:Object(i.a)({},x,{background:E===a?"#9999FF":"#fff",color:E===a?"white":"black",borderRadius:a===e.length-1?"0 0 1rem 1rem":"0"}),key:"dropdownOption".concat(a),onClick:function(){T(n),g(n.display)},onMouseOver:function(){C(n.mapObject),O(a)},onMouseLeave:function(){C(null),O(null)},onContextMenu:function(e){return e.preventDefault()}},n.display))})),t}(c):null))},Qe=(n(26),function(e){return r.a.createElement("div",{className:"deleteConfirmScreen"},r.a.createElement("h3",{className:"deleteConfirmLabel"},"Are you sure you want to delete ",e.deleteModeOnAll?"ALL saved maps?":"the following saved map?"),r.a.createElement("img",{alt:"",src:e.deleteModeOnAll?null:e.mapIcon,style:{display:e.deleteModeOnAll?"none":"block"},className:"confirmDeleteIcon"}),r.a.createElement("div",{className:"deleteButtons"},r.a.createElement(Se,{className:"confirmDeleteBtn",key:"confirmDeleteBtn",onClick:function(){e.deleteModeOnAll?je():Ce(e.gameState.seed),e.quitToLoadScreen()},text:"Confirm"}),r.a.createElement(Se,{className:"cancelDeleteBtn",key:"cancelDeleteBtn",onClick:function(){e.quitToLoadScreen()},text:"Cancel"})))}),Ye=function(e){return r.a.createElement(Se,{className:"returnToMainMenuBtn",key:"returnToMainMenuBtn",onClick:function(){e.setCurrentScreen("mainMenu")},text:"Return To Main Menu"})};function Ke(){var e=Te(),t=[];return e.forEach(function(){var e=Object(f.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.push({display:n.name,seed:n.seed,size:n.size,mapObject:n.mapObject});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t}var Ze=function(e){var t=Object(a.useState)("load"),n=Object(l.a)(t,2),c=n[0],o=n[1],u=Object(a.useState)(null),m=Object(l.a)(u,2),p=m[0],h=m[1];function d(){return(d=Object(f.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=h,!t){e.next=7;break}return e.next=4,ze(t,!1);case 4:e.t1=e.sent,e.next=8;break;case 7:e.t1=null;case 8:e.t2=e.t1,(0,e.t0)(e.t2);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}if("load"===c)return r.a.createElement("div",{className:"menu loadMapScreen"},r.a.createElement(Je,{className:"loadMapDropdown",style:{width:"12rem",height:"2rem"},placeholder:"Select a map",options:Ke(),onChange:function(t){t.display;var n=Object(Xe.a)(t,["display"]);e.setGameState(Object(i.a)({},e.gameState,{},n))},onHover:function(e){null!==e&&function(e){d.apply(this,arguments)}(e)}}),r.a.createElement("img",{alt:"",src:p,className:"mapIcon",style:{border:p?"0.15rem #aaa solid":"none"}}),r.a.createElement(Se,{className:"loadSaveMapBtn",key:"loadSaveMapBtn",onClick:function(){e.gameState.mapObject&&e.setGameState(Object(i.a)({},e.gameState,{active:!0}))},text:"Load Map"}),r.a.createElement(Se,{className:"deleteSaveMapBtn",key:"deleteSaveMapBtn",onClick:function(){p&&o("deleteOne")},text:"Delete Map"}),r.a.createElement(Se,{className:"deleteAllSavedMapsBtn",key:"deleteAllSavedMapsBtn",onClick:function(){return o("deleteAll")},text:"Delete All Maps"}),r.a.createElement(Ye,e));var v="deleteOne"!==c;return r.a.createElement(Qe,Object.assign({},e,{mapIcon:p,deleteModeOnAll:v,quitToLoadScreen:function(){h(null),o("load")}}))},$e=(n(27),n(16)),_e=n.n($e);var et=function(e,t){var n=at(e),a=tt(n,t.parameters);return a=nt(a,t.tiles)},tt=function(e,t){var n=t.mapWidth,a=t.mapHeight;return e.filter((function(e){return e[0]>=0&&e[1]>=0&&e[0]<n&&e[1]<a}))},nt=function(e,t){return A(t,e)},at=function(e){return Array(4).fill(e).map((function(e,t){return[e[0]+(t-1)%2,e[1]+(t-2)%2]}))},rt=function(e,t){for(var n=t.parameters,a=n.mapWidth,r=n.mapHeight,c=Object(m.a)(t.tiles),o=[e],l=0;l<a*r;l++){var u=o.map((function(e){return et(e,Object(i.a)({},t,{tiles:c}))}));if(u=[].concat.apply([],u),o.forEach((function(e){return c.push(e)})),o=[],0===u.length)break;(u=I(u)).forEach((function(e){return o.push(e)}))}return G(t.end,c)},ct=function(e,t){var n=function(e,t){var n=function(e,t){for(var n,a=e,r=[],c=0;c<2;c++)for(var o=0;o<2;o++){var i=lt(a,{x:o,y:c},t);r.push(i),a=A(i,e)}return(n=[]).concat.apply(n,r)}(e,t),a=(n=function(e){var t=Object(m.a)(e);return e.filter((function(e){var n=function(e,t){var n=at(e);return 4-A(t,n).length}(e,t)>1;return n&&(t=A([e],t)),!n}))}(n)).map((function(t){return L(t,e)}));return Object(m.a)(new Set(a))}(e,t),a={mapLength:e.length,difficulty:t.difficulty},r=ot(n,a),c=function(e){return[0,e.length-1]}(e);return Object(m.a)(new Set([].concat(Object(m.a)(r),Object(m.a)(c))))},ot=function(e,t){var n=t.mapLength,a=t.difficulty,r=it(e,n);return 1===a?[].concat(Object(m.a)(e),Object(m.a)(r)):2===a?[].concat(Object(m.a)(e),Object(m.a)(V(r))):3===a?e:4===a?V(e):5===a?[]:void 0},it=function(e,t){var n=function(e){for(var t,n,a=e.length;a;)n=Math.floor(Math.random()*a),t=e[--a],e[a]=e[n],e[n]=t;return e}(Object(m.a)(Array(t).keys()).filter((function(t){return-1===e.indexOf(t)})));return V(n)};function lt(e,t,n){return function(e){var t=e.map((function(e){return e[z(0,e.length-1)]}));return I(t)}(function(e,t){return t.filter((function(t){return function(e,t){return 4===function(e){for(var t=e.map((function(e){return I(e)})),n=t[0],a=0;a<t.length-1;a++){var r=[].concat(Object(m.a)(n),Object(m.a)(t[a+1]));n=P(r)}return n}([e,t]).length}(t,e)}))}(e,function(e,t){for(var n=t.mapWidth,a=t.mapHeight,r=[],c=e.y;c<a-1-e.y;c+=2)for(var o=e.x;o<n-1-e.x;o+=2)r.push(ut(o,c));return r}(t,n)))}function ut(e,t){for(var n=[],a=0;a<2;a++)for(var r=0;r<2;r++)n.push([r+e,a+t]);return n}var st=function(e,t){return e=e.filter((function(e){return!B(e,t.end)}))},ft=function(e,t){return e=e.filter((function(e){return!function(e,t){var n=function(e,t){return function(e,t){var n=mt(t);return-1!==L(e,n)}(e,t)?function(e){var t=function(e){for(var t=[],n=-1;n<=1;n++)for(var a=-1;a<=1;a++)t.push([e[0]+n,e[1]+a]);return t}(e.end);return tt(t,e.parameters)}(t):mt(t)}(e,t),a=!1;return n.forEach((function(t){B(e,t)&&(a=!0)})),a}(e,t)}))};function mt(e){var t=at(e.end);return tt(t,e.parameters)}var pt=function(e,t){return ht(t,.5)||(e=e.filter((function(e){return!dt(e,t)}))),e},ht=function(e,t){var n=e.parameters,a=t*n.mapWidth*n.mapHeight;return e.tiles.length>=a},dt=function(e,t){for(var n=Object(i.a)({},t,{tiles:[].concat(Object(m.a)(t.tiles),[e])}),a=et(e,t),r=0;r<a.length;r++)if(!rt(a[r],n))return!0;return!1},vt=function(e,t){return t.tiles.length>2&&(e=e.filter((function(e){return!bt(e,t.tiles)}))),e},bt=function(e,t){var n=yt(3,t),a=[e].concat(Object(m.a)(n)),r=gt(a);return kt(r)},gt=function(e){for(var t=[],n=0;n<e.length-1;n++)t.unshift($(e[n],e[n+1]));return t},yt=function(e,t){return t.slice(Math.max(t.length-e,0)).reverse()},kt=function(e){var t=!1;return(B(e,[0,1,2])||B(e,[1,2,3])||B(e,[2,3,0])||B(e,[3,0,1]))&&(t=!0),(B(e,[3,2,1])||B(e,[2,1,0])||B(e,[1,0,3])||B(e,[0,3,2]))&&(t=!0),t},Et=function(e,t){var n=function(e,t){for(var n=e.map((function(e){return Ot(e,t)})),a=St(n),r=[],c=0;c<a.length;c++)r.push(e[a[c]]);return r}(e,t);return D(n)?Object(m.a)(n):e};var Ot=function(e,t){for(var n=t.parameters,a=n.mapWidth,r=n.mapHeight,c=Object(m.a)(t.tiles),o=[e],l=0;l<a*r;l++){var u=o.map((function(e){return et(e,Object(i.a)({},t,{tiles:c}))}));if(u=[].concat.apply([],u),o.forEach((function(e){return c.push(e)})),o=[],G(t.end,c))return l;(u=I(u)).forEach((function(e){return o.push(e)}))}},St=function(e){for(var t=e[e.indexOf(Math.max.apply(Math,Object(m.a)(e)))],n=[],a=0;a<e.length;a++)e[a]===t&&n.push(a);return n},xt=function(e){_e()(e.seed,{global:!0});var t={mapWidth:e.size,mapHeight:e.size,difficulty:e.difficulty},n={tracks:[],headerLabels:[]},a=function(e){var t=function(e){var t=function(e){for(var t=e.mapWidth,n=e.mapHeight,a=[],r=0;r<t-1;r++)a.push([r,0]);for(var c=0;c<n-1;c++)a.push([t-1,c]);for(var o=t-1;o>0;o--)a.push([o,n-1]);for(var i=n-1;i>0;i--)a.push([0,i]);return a}(e);return[t.splice(Math.floor(Math.random()*t.length),1)[0],t.splice(Math.floor(Math.random()*t.length),1)[0]]}(e),n=Object(l.a)(t,2),a=n[0],r=n[1],c={start:a,end:r,tiles:[a],current:a,parameters:e},o=!1;for(;!o;){var i=wt(c);c.tiles.push(i),c.current=i,B(i,c.end)&&(o=!0)}return c.tiles}(t),r=function(e){for(var t=[],n=0;n<e.length;n++)(0===e[n]&&0===e[n+1]||2===e[n]&&2===e[n+1])&&t.push("vertical"),(1===e[n]&&1===e[n+1]||3===e[n]&&3===e[n+1])&&t.push("horizontal"),(2===e[n]&&1===e[n+1]||3===e[n]&&0===e[n+1])&&t.push("topRightCorner"),(3===e[n]&&2===e[n+1]||0===e[n]&&1===e[n+1])&&t.push("bottomRightCorner"),(0===e[n]&&3===e[n+1]||1===e[n]&&2===e[n+1])&&t.push("bottomLeftCorner"),(1===e[n]&&0===e[n+1]||2===e[n]&&3===e[n+1])&&t.push("topLeftCorner");return t}(ee(a,t)),c=ct(a,t);n.headerLabels=function(e,t){for(var n=t.mapWidth,a=t.mapHeight,r={x:[],y:[]},c=0;c<n;c++)r.x.push(_([c,-1],e)[2].length);for(var o=0;o<a;o++)r.y.push(_([-1,o],e)[1].length);return r}(a,t);for(var o=0;o<a.length;o++){var i=c.includes(o);n.tracks.push({tile:a[o],railType:r[o],defaultTrack:i})}return n};function wt(e){var t=et(e.current,e);return function(e,t){return 1===e.length&&B(e[0],t)}(t,e.end)?e.end:(t=function(e,t){var n=[];n.push(st),n.push(ft),n.push(pt),n.push(vt),n.push(Et);for(var a=0;a<n.length;a++){var r=(0,n[a])(e,t);if(!D(r))break;e=r}return e}(t=t.filter((function(t){return rt(t,e)})),e))[z(0,t.length-1)]}var Tt=function(e){var t=Object(a.useState)(!1),n=Object(l.a)(t,2),c=n[0],o=n[1];return Object(a.useEffect)((function(){function e(){return(e=Object(f.a)(s.a.mark((function e(){var t,n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=xt({size:6,seed:0xe4d067d44f90,difficulty:3}),e.next=4,ze(t,!1);case 4:return n=e.sent,e.next=7,ze(t,!0);case 7:a=e.sent,o({empty:n,complete:a});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),r.a.createElement("div",{className:"howToPlayScreen",key:"howToPlayScreen"},r.a.createElement("h2",{className:"howToPlayTitle"},"How To Play"),r.a.createElement("div",{className:"howToPlayGrid",style:{opacity:c?"1":"0"}},r.a.createElement("div",{className:"howToPlayMapField"},r.a.createElement("img",{className:"howToPlayMap",alt:"",src:c.empty})),r.a.createElement("div",{className:"howToPlayTextField"},r.a.createElement("p",null,"The goal of the game is to create a train track path between the entrance and the exit of the board."),r.a.createElement("p",null,"Each row and column must contain the specified amount of tracks in the corresponding header. Headers display green if correct and red if overfilled."),r.a.createElement("p",null,"Tracks cannot overlap. In order to win the path must be fully connected with no extra tracks."),r.a.createElement("p",null,"Default tiles (such as the entrance and exit) cannot be removed from the map. The higher the difficulty selected, the less default tiles on the map.")),r.a.createElement("div",{className:"howToPlayMapField"},r.a.createElement("img",{className:"howToPlayMap",alt:"",src:c.complete})),r.a.createElement("div",{className:"howToPlayTextField"},r.a.createElement("p",null,"Left clicking places a track. Hovering over different sections of a tile will show what type of track will be placed on left click."),r.a.createElement("p",null,"Right clicking places an X mark. X marks are for labelling tiles where you know there is no track."),r.a.createElement("p",null,"Pressing both mouse buttons at the same time places a dot mark. Dot marks are for labelling tiles where you know there is a track but are not sure which type."),r.a.createElement("p",null,"Holding down a mouse button and dragging over other tiles will place multiple tracks/markers."))),r.a.createElement(Ye,e))},Ct=(n(36),function(e){var t=Object(a.useState)(!1),n=Object(l.a)(t,2),c=n[0],o=n[1],u={position:"absolute",height:"1.5rem",width:"1.5rem",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #444",backgroundColor:"white",borderRadius:"100%",zIndex:"-1",opacity:"0",transition:"0.5s",transform:"translate(".concat(67.5*(e.gameState.difficulty-3),"%, 100%)")},s={transform:"translate(".concat(67.5*(e.gameState.difficulty-3),"%, 120%)"),opacity:"1",transition:"1s"},f=c?Object(i.a)({},u,{},s):u;return r.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement("input",{className:"difficultySlider",onChange:function(t){return e.setGameState(Object(i.a)({},e.gameState,{difficulty:parseInt(t.target.value)}))},type:"range",min:"1",max:"5",value:e.gameState.difficulty,style:{width:"".concat(5,"rem")},onMouseOver:function(){return o(!0)},onMouseLeave:function(){return o(!1)}}),r.a.createElement("div",{className:"difficultyLabel",style:f},e.gameState.difficulty))});function jt(){for(var e=[],t=0;t<3;t++){var n=6+2*t;e.push({display:"".concat(n,"x").concat(n),value:n})}return e}var Mt=function(e){return Object(a.useEffect)((function(){e.setGameState(Object(i.a)({},e.gameState,{seed:W()}))}),[]),r.a.createElement("div",{className:"menu startMapScreen"},r.a.createElement("div",{className:"startMapOptionsContainer"},r.a.createElement("p",{className:"startMapOptionLabel",key:"Map Size Label"},"Map Size"),r.a.createElement(Je,{key:"selectMapSize",style:{width:"3rem",height:"2rem",textAlign:"center",padding:"0 1.25rem 0 0.5rem"},options:jt(),className:"mapSizeOption",placeholder:"".concat(e.gameState.size,"x").concat(e.gameState.size),onHover:function(){return null},onChange:function(t){e.setGameState(Object(i.a)({},e.gameState,{size:t.value}))}}),r.a.createElement("p",{className:"startMapOptionLabel",key:"Map Seed Label"},"Map Seed"),r.a.createElement("div",{className:"mapSeedOptionRow"},r.a.createElement("input",{key:"mapSeedInput",type:"text",className:"mapSeedInput",id:"mapSeedInput",defaultValue:e.gameState.seed,onChange:function(t){return e.setGameState(Object(i.a)({},e.gameState,{seed:t.target.value}))},style:{width:"8rem",textAlign:"center"}}),r.a.createElement("div",{key:"rerollSeedBtn",className:"rerollSeedBtn",onClick:function(t){t.preventDefault(),e.setGameState(Object(i.a)({},e.gameState,{seed:W()}))}},r.a.createElement("span",{className:"diceSymbol"},"\u2684"))),r.a.createElement("p",{className:"startMapOptionLabel"},"Difficulty:"),r.a.createElement("div",{className:"startMapSliderRow"},r.a.createElement(Ct,e),r.a.createElement("div",{className:"questionBox difficultyQuestionBox"},"?"),r.a.createElement("div",{className:"startOptionExplanation difficultyExplanation"},"Adjusts the amount of default tiles in game. Difficulty 3 ensures the absolute minimum amount of default tiles required for a map that has one definitive solution.",r.a.createElement("br",null),r.a.createElement("br",null),"Difficulties above 3 may require trial and error and will likely have multiple possible solutions (only one solution accepted).")),r.a.createElement("p",{className:"startMapOptionLabel"},"Theme Color:"),r.a.createElement("div",{className:"startMapSliderRow"},r.a.createElement("input",{className:"colorSlider",onChange:function(t){return e.setThemeColor(Object(i.a)({},e.themeColor,{selected:parseInt(t.target.value)}))},type:"range",min:0,max:e.themeColor.available.length-1,value:e.themeColor.selected,style:{width:"".concat(10,"rem")}}),r.a.createElement("div",{className:"colorDemoBox",style:{backgroundColor:e.themeColor.available[e.themeColor.selected]}})),r.a.createElement("div",{className:"startOptionOptionRow"},r.a.createElement("input",{type:"checkbox",className:"startOptionCheckbox",defaultChecked:!e.visualEffects,onChange:function(t){return e.setVisualEffects(!t.target.checked)}}),r.a.createElement("p",{className:"startOptionRowLabel"},"Disable Visual Effects"),r.a.createElement("div",{className:"questionBox visualEffectsQuestionBox"},"?"),r.a.createElement("div",{className:"startOptionExplanation visualEffectsExplanation"},"Disables the game background and win display visual effects.",r.a.createElement("br",null),r.a.createElement("br",null),"Can increase performance on old browsers/PCs.")),r.a.createElement(Se,{className:"generateMapBtn",key:"generateMapBtn",onClick:function(){e.generateMap()},text:"Generate Map"})),r.a.createElement(Ye,e))},Nt=function(e){return r.a.createElement("div",{className:"menu aboutScreen"},r.a.createElement("p",null,"This game was created with React."),r.a.createElement("p",null,r.a.createElement("a",{href:"https://github.com/morgan-sam/Train-Tracks-React"},"Source Code")),r.a.createElement("p",null,"Samuel Morgan - 2020"),r.a.createElement(Ye,e))},Rt=function(e){return r.a.createElement("div",{className:"menu mainMenu",key:"mainMenuScreen"},r.a.createElement(Se,{className:"startGameBtn",key:"startGameBtn",onClick:function(){e.setCurrentScreen("startMap")},text:"Start Game"}),r.a.createElement(Se,{className:"loadSavedGameBtn",key:"loadSavedGameBtn",onClick:function(){e.setCurrentScreen("loadMap")},text:"Load Saved Map"}),r.a.createElement(Se,{className:"howToPlayPageBtn",key:"howToPlayPageBtn",onClick:Object(f.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setCurrentScreen("howToPlay");case 1:case"end":return t.stop()}}),t)}))),text:"How To Play"}),r.a.createElement(Se,{className:"aboutBtn",key:"aboutBtn",onClick:function(){e.setCurrentScreen("about")},text:"About"}))},zt=function(e){return r.a.createElement("div",{className:"screen",key:e.currentScreen},r.a.createElement("h1",{key:"title",className:"gameTitle"},"Train Tracks"),function(t){switch(t){case"mainMenu":return r.a.createElement(Rt,e);case"startMap":return r.a.createElement(Mt,e);case"loadMap":return r.a.createElement(Ze,e);case"howToPlay":return r.a.createElement(Tt,e);case"about":return r.a.createElement(Nt,e);case"game":return r.a.createElement(Fe,e);default:return r.a.createElement(Rt,e)}}(e.currentScreen))},Lt=function(e){var t=H(e);return Bt(t).toDataURL("image/png")},Bt=function(e){var t=document.createElement("canvas");return t.width=e,t.height=e,t.context=Dt(t),t.context=It(t,e/3),t},Dt=function(e){var t=e.getContext("2d");return t.fillStyle="white",t.fillRect(0,0,e.width,e.height),t},It=function(e,t){var n=e.getContext("2d"),a=e.width/2,r=e.height/2;n.save(),n.beginPath(),n.arc(a,r,t,0,2*Math.PI,!0),n.clip(),n.clearRect(a-t,r-t,2*t,2*t),n.restore()},Pt=function(e){var t=H(e);return At(t).toDataURL("image/png")},At=function(e){var t=document.createElement("canvas");return t.width=e,t.height=e,t.context=Wt(t),t.context=Ht(t),t},Wt=function(e){var t=e.getContext("2d");return t.fillStyle="white",t.fillRect(0,0,e.width,e.height),t},Ht=function(e){var t=e.getContext("2d"),n=e.width/2,a=e.height/2;t.save(),t.beginPath(),t.translate(n,a),t.rotate(45*Math.PI/180),t.rect(-2.5,-25,5,50),t.rotate(90*Math.PI/180),t.rect(-2.5,-25,5,50),t.clip(),t.translate(-n,-a),t.clearRect(0,0,e.width,e.height)},Gt=function(){var e=Object(a.useState)({size:8,seed:W(),difficulty:3,mapObject:null,active:!1,visualEffects:!0}),t=Object(l.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)("mainMenu"),u=Object(l.a)(o,2),s=u[0],f=u[1],m=Object(a.useState)(3.5),p=Object(l.a)(m,2),h=p[0],d=(p[1],Object(a.useState)({unknown:Lt(h),cross:Pt(h)})),v=Object(l.a)(d,2),b=v[0],g=(v[1],Object(a.useState)({available:ke(),selected:0})),y=Object(l.a)(g,2),k=y[0],E=y[1],O=Object(a.useState)(!0),S=Object(l.a)(O,2),x=S[0],w=S[1];function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.seed,t={size:n.size,seed:e,difficulty:n.difficulty},a=xt(t);c(Object(i.a)({},n,{seed:e,mapObject:a,active:!0}))}Object(a.useEffect)((function(){null!==n.mapObject&&n.active&&f("game")}),[n.mapObject,n.active]),Object(a.useEffect)((function(){var e=document.getElementById("mapSeedInput");e&&(e.value=n.seed)}),[n.seed]);var C={currentScreen:s,setCurrentScreen:f,gameState:n,setGameState:c,inGameNewMap:function(){T(W())},generateMap:T,quitGame:function(){f("mainMenu"),c(Object(i.a)({},n,{mapObject:null,seed:W(),active:!1}))},tileRemSize:h,railImages:b,themeColor:k,setThemeColor:E,visualEffects:x,setVisualEffects:w};return r.a.createElement("div",{key:"app",className:"app"},r.a.createElement("div",{key:"screenContainer",className:"screenContainer"},r.a.createElement(zt,C)))};n(37),n(38);o.a.render(r.a.createElement(Gt,null),document.getElementById("root"))}],[[18,1,2]]]);
//# sourceMappingURL=main.ac066db2.chunk.js.map